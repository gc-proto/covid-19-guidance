<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">

<head>
  <meta charset="utf-8" />
  <!-- Web Experience Toolkit (WET) / Boîte à outils de l'expérience Web (BOEW) wet-boew.github.io/wet-boew/License-en.html / wet-boew.github.io/wet-boew/Licence-fr.html -->
  <title>Canada Emergency Wage Subsidy (CEWS) – Canada.ca</title>
  <meta content="width=device-width,initial-scale=1" name="viewport" />
  <meta name="robots" content="noindex" />
  <!-- Meta data -->

  <!-- Load closure template scripts -->

  <script type="text/javascript"
    src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_30/cdts/compiled/soyutils.js"></script>
  <script type="text/javascript"
    src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_30/cdts/compiled/wet-en.js"></script>
  <link href="https://test.canada.ca/covid-19-guidance/proto/css/alpha-beta-banner.css" rel="stylesheet" />
  <link href="../css/cews.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
    integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
  <!-- Write closure template -->
  <script type="text/javascript">
    document.write(wet.builder.refTop({
    }));
  </script>
</head>

<body vocab="http://schema.org/" typeof="WebPage">
  <div id="def-top">
  </div>
  <!-- Write closure template -->
  <script type="text/javascript">
    var defTop = document.getElementById("def-top");
    defTop.outerHTML = wet.builder.top({
      lngLinks: [{

        lang: "fr",
        href: "how-much-mt-fr.html",
        text: "Français"
      }],
      breadcrumbs: [{
        title: "Canada.ca",
        href: "https://www.canada.ca/en.html"
      }, {
        title: "Business and industry",
        href: "https://www.canada.ca/en/services/business.html"
      }, {
        title: "Canada Emergency Wage Subsidy (CEWS)",
        href: "index.html"
      }],
      search: true,
      siteMenu: true,
      showPreContent: true
    });
  </script>
  <main property="mainContentOfPage" class="container">
    <section class="gc-nav">
      <h1 property="name" id="wb-cont-nav">Canada Emergency Wage Subsidy (CEWS)</h1>
      <ul id="gc-navseq-nav" class="hidden-xs hidden-sm">
        <li> <a class="gc-navseq-nav-btn" href="#gc-navseq-header">Go to navigation menu</a> </li>
        <li> <a class="gc-navseq-nav-btn" href="#wb-cont">Skip to main content</a> </li>
      </ul>
      <nav aria-label="Section menu">
        <h2 id="gc-navseq-header" class="mrgn-tp-0 hidden-xs hidden-sm">Sections</h2>
        <ul class="gc-navseq">
          <li><a href="overview.html">What the changes are</a></li>
          <li><a href="who-apply.html">Who can apply</a></li>
          <li><a href="periods.html">Periods you can apply for</a></li>
          <li><a href="who-employees.html">Which of your employees qualify</a></li>
          <li class="active"><a aria-current="page">Calculate your subsidy amount</a>
            <ul class="gc-navseq noline">
              <li><a href="how-much-reduction.html">How the revenue drop and subsidy rate are calculated</a></li>
              <li><a href="how-much-version-math.html">How the subsidy is calculated</a></li>
            </ul>
          </li>
          <li><a href="how-apply.html">How to apply</a></li>
          <li><a href="after.html">After you apply</a></li>
          <li><a href="contact.html">Contact us about CEWS</a></li>

        </ul>
        <div class="hidden-sm hidden-xs" data-ajax-replace="index.html #related-menu>"> </div>
      </nav>
    </section>
    <section class="gc-nav-section experimental">

      <h1 property="name" id="wb-cont">Calculate your subsidy amount</h1>
      <h2 class="h3 mrgn-tp-sm">On this page</h2>
      <ul>
        <li><a href="#h-1">How the calculator helps you</a></li>
        <li><a href="#h-2">Before you start the calculation</a></li>
        <li><a href="#h-3">Use the calculator</a></li>
      </ul>
      <h2 id="h-1">How the calculator helps you</h2>
     <p>Use this calculator before you apply for the subsidy.</p>
<ol>
  <li>Calculate your subsidy amount by  entering employee pay information</li>
  <li>Print and save the numbers you'll  need to enter when you apply</li>
  <li>Apply for the subsidy online through  My Business Account, Represent a Client, or the Web Forms application using the  information you printed</li>
</ol>
      <p>You can currently use the calculator for claim periods 1 to 6. More periods will be added as they become
        available. </p>
      <p>For the <a href="overview.html">changes to the rules beginning in claim period 5</a>, the calculator
        automatically applies the best subsidy rate you qualify for (including applying the safe harbour and deeming
        rules) based on information you enter. </p>
      <p>To understand the math behind the wage subsidy calculation, refer to <a href="how-much-version-math.html">how
          the subsidy is calculated</a>.</p>
      <section>
       <h2 id="h-2">Before you start the calculation</h2>
        <p class="lead">Check these boxes to confirm you are prepared before you start your calculations:</p>
        <section>
  <ul class="checkbox-lg checkbox-zebra">
    <li class="checkbox">
      <input type="checkbox" id="bfore1" class="action-checkbox">
      <label for="bfore1">You are an eligible employer during this claim period</label>
      <ul class="mrgn-lft-lg list-unstyled">
        <li><a href="who-apply.html">Who can apply</a></li>
      </ul>
    </li>
    <li class="checkbox">
      <input type="checkbox" id="bfore2" class="action-checkbox">
      <label for="bfore2"><strong>Both of the following apply:</strong></label>
      <p>
        <label for="bfore2">You know which of your employees are eligible for this 
          period</label>
      </p>
      <ul class="mrgn-lft-lg list-unstyled">
        <li><a href="who-employees.html">Which of your employees qualify</a></li>
      </ul>
      <div class="row mrgn-tp-sm mrgn-bttm-sm">
        <div class="col-xs-3 col-sm-2">
          <p class="col-xs-12 pstn-tp-xs pstn-lft-xs text-center"><span class="fa-stack fa-fw text-muted text-center"> <span class="fas fa-circle fa-stack-2x"></span><span
                        class="fa-stack-1x fa-inverse small">and</span></span></p>
          <hr class="brdr-bttm">
        </div>
      </div>
      <p>
        <label for="bfore2">You have access to their pay information</label>
      </p>
      <ul class="mrgn-lft-lg list-unstyled">
        <li><a href="who-employees.html#h-2">Determining employee pay (eligible remuneration)</a></li>
      </ul>
    </li>
    <li class="checkbox">
      <input type="checkbox" id="bfore3" class="action-checkbox">
      <label for="bfore3"><strong>Both of the following apply:</strong></label>
      <p>
        <label for="bfore3">You know if you had any eligible employees on leave with pay for any full weeks
          during the claim period</label>
      </p>
      <ul class="list-unstyled mrgn-lft-lg">
        <li><a href="#lwp" aria-controls="lwp" class="wb-lbx" role="button">Active employees and employees on
          leave with pay&nbsp;<span class="far fa-question-circle"></span></a></li>
      </ul>
      <div class="row mrgn-tp-sm mrgn-bttm-sm">
        <div class="col-xs-3 col-sm-2">
          <p class="col-xs-12 pstn-tp-xs pstn-lft-xs text-center"><span class="fa-stack fa-fw text-muted text-center"> <span class="fas fa-circle fa-stack-2x"></span><span class="fa-stack-1x fa-inverse small">and</span></span></p>
          <hr class="brdr-bttm">
        </div>
      </div>
      <p>
        <label for="bfore3">You have calculated the employer portion of their EI, QPIP, CPP and QPP
          contributions during the claim
          period</label>
      </p>
      <ul class="list-unstyled mrgn-lft-lg">
        <li><a href="#contributions" aria-controls="contributions" class="wb-lbx" role="button">EI, QPIP,
          CPP and QPP contributions&nbsp;<span class="far fa-question-circle"></span></a></li>
      </ul>
    </li>
    <li class="checkbox">
      <input type="checkbox" id="bfore4" class="action-checkbox">
      <label for="bfore4">You have  your monthly eligible revenue amounts from 2020 and 2019</label>
    </li>
    <li class="checkbox">
      <input type="checkbox" id="bfore5" class="action-checkbox">
      <label for="bfore5"><strong>One of the following applies:</strong></label>
      <p>
        <label for="bfore5">You are calculating a claim for period 5 to 9, and you understand that the 10%
          wage subsidy does not apply</label>
      </p>
      <div class="row mrgn-tp-sm mrgn-bttm-sm">
        <div class="col-xs-3 col-sm-2">
          <p class="col-xs-12 pstn-tp-xs pstn-lft-xs text-center"><span class="fa-stack fa-fw text-muted text-center"> <span class="fas fa-circle fa-stack-2x"></span><span class="fa-stack-1x fa-inverse small">or</span></span></p>
          <hr class="brdr-bttm">
        </div>
      </div>
      <p>
        <label for="bfore5">You are calculating a claim for periods 1 to 4, and you know the amount (if any) you calculated for the 10% wage subsidy</label>
      </p>
      <ul class="list-unstyled mrgn-lft-lg">
        <li><a href="#tempwage" aria-controls="tempwage" class="wb-lbx" role="button">10% Temporary Wage
          Subsidy for Employers program amount&nbsp;<span class="far fa-question-circle"></span></a> </li>
      </ul>
    </li>
    <li class="checkbox">
      <input type="checkbox" id="bfore6" class="action-checkbox">
      <label for="bfore6"><strong>One of the following applies:</strong></label>
      <p>
        <label for="bfore6">You know the total amount your eligible employees received under the
          Work-Sharing benefit program through Employment Insurance for this claim period</label>
      </p>
      <ul class="list-unstyled mrgn-lft-lg">
        <li><a href="#worksharing" aria-controls="worksharing" class="wb-lbx" role="button">Work-Sharing
          benefit program through Employment Insurance amount&nbsp;<span class="far fa-question-circle"></span></a></li>
      </ul>
      <div class="row mrgn-tp-sm mrgn-bttm-sm">
        <div class="col-xs-3 col-sm-2">
          <p class="col-xs-12 pstn-tp-xs pstn-lft-xs text-center"><span class="fa-stack fa-fw text-muted text-center"> <span class="fas fa-circle fa-stack-2x"></span><span class="fa-stack-1x fa-inverse small">or</span></span></p>
          <hr class="brdr-bttm">
        </div>
      </div>
      <p>
        <label for="bfore6">You did not participate in the Work-Sharing program (enter $0)</label>
      </p>
      </div>
    </li>
  </ul>		
         <!-- <ul class="checkbox-lg checkbox-zebra">
            <li class="checkbox">
              <input type="checkbox" id="bfore1" class="action-checkbox">
              <label for="bfore1">You are an eligible employer during this claim period</label>
              <ul class="mrgn-lft-lg list-unstyled">
                <li><a href="who-apply.html">Who can apply</a></li>
              </ul>
            </li>
            <li class="checkbox">
              <input type="checkbox" id="bfore2" class="action-checkbox">
              <label for="bfore2">You have determined which of your employees are eligible during the claim
                period</label>
              <ul class="mrgn-lft-lg list-unstyled">
                <li><a href="who-employees.html">Which of your employees qualify</a></li>
              </ul>
              <label for="bfore2"><strong>and</strong></label>
              <br>
              <label for="bfore2">you have access to their pay information</label>
              <ul class="mrgn-lft-lg list-unstyled">
                <li><a href="who-employees.html#h-2">Determining employee pay (eligible remuneration)</a></li>
              </ul>
            </li>
            <li class="checkbox">
              <input type="checkbox" id="bfore3" class="action-checkbox">
              <label for="bfore3">You know if you had any eligible employees on leave with pay for any full weeks
                during the claim period</label>
              <ul class="list-unstyled mrgn-lft-lg">
                <li><a href="#lwp" aria-controls="lwp" class="wb-lbx" role="button">Active employees and employees on
                    leave with pay&nbsp;<span class="far fa-question-circle"></span></a></li>
              </ul>
              <label for="bfore3"><strong>and</strong></label>
              <br>
              <label for="bfore3">you have calculated the employer portion of their EI and QPIP, and CPP or QPP
                contributions during the claim
                period</label>
              <ul class="list-unstyled mrgn-lft-lg">
                <li><a href="#contributions" aria-controls="contributions" class="wb-lbx" role="button">EI and QPIP,
                    and CPP or QPP contributions&nbsp;<span class="far fa-question-circle"></span></a></li>
              </ul>
            </li>
            <li class="checkbox">
              <input type="checkbox" id="bfore4" class="action-checkbox">
              <label for="bfore4">You have information about your monthly eligible revenue from 2020 and 2019</label>
            </li>
            <li class="checkbox">
              <input type="checkbox" id="bfore5" class="action-checkbox">
              <label for="bfore5"><strong>One of the following applies:</strong></label>
              <ul class="std-blt lst-spcd">
                <li>
                  <label for="bfore5">you are calculating a claim for periods 1 to 4, and if you calculated for the 10%
                    wage subsidy you know the amount</label>
                  <ul class="list-unstyled mrgn-lft-lg">
                    <li><a href="#tempwage" aria-controls="tempwage" class="wb-lbx" role="button">10% Temporary Wage
                        Subsidy for Employers program amount&nbsp;<span class="far fa-question-circle"></span></a> </li>
                  </ul>
                  <label for="bfore5"><strong>or</strong></label>
                </li>
                <li>
                  <label for="bfore5">you are calculating a claim for period 5 to 9, and you understand that the 10%
                    wage subsidy no longer applies</label>
                </li>
              </ul>
            </li>
            <li class="checkbox">
              <input type="checkbox" id="bfore6" class="action-checkbox">
              <label for="bfore6"><strong>One of the following applies:</strong></label>
              <ul class="std-blt lst-spcd">
                <li>
                  <label for="bfore6">you know the total amount your eligible employees received under the
                    Work-Sharing benefit program through Employment Insurance for this claim period</label>
                  <ul class="list-unstyled mrgn-lft-sm">
                    <li><a href="#worksharing" aria-controls="worksharing" class="wb-lbx" role="button">Work-Sharing
                        benefit program through Employment Insurance amount&nbsp;<span
                          class="far fa-question-circle"></span></a></li>
                  </ul>
                  <label for="bfore6"><strong>or</strong></label>
                </li>
                <li>
                  <label for="bfore6">you did not participate in the Work-Sharing program (enter $0)</label>
                </li>
              </ul>
            </li>
          </ul>//-->
          <div class="alert alert-danger provisional" id="action-no-msg">
            <p>You should understand the definitions and gather all the necessary information before you calculate
              your claim.</p>
          </div>
          <div class="alert alert-success hidden provisional" id="action-msg1">
            <p>You can now proceed to calculate the amounts you will need for your claim. </p>
          </div>
        </section>
      </section>
      <h2 id="h-3">Use the calculator</h2>
      <details>
        <summary>Privacy statement: This calculator does not collect or store your information</summary>
        <p>The CRA is not collecting or retaining any of the information you enter on this page or in the calculation
          spreadsheet. These amounts are only used to help you determine the amount of CEWS you may be eligible to
          claim. You may be required to provide a full list of your employees and their Social Insurance Numbers (SIN)
          for verification after you apply.</p>
        
      </details>
 <p><strong>Warning:</strong> This calculator does not save any data and if you leave or refresh this page you may need to enter the information again.</p>	
      <!--INSERTED FORM BEGINS HERE-->	
      <div class="wb-frmvld">
        <form method="get" class="mrgn-bttm-lg" id="cews-cal">
          <ol class="lst-stps">
            <li id="stp1">
              <fieldset>
                <legend><span class="wb-inv">Step 1: </span>Claim period</legend>
                <div class="form-group">
                  <label for="claim-period" class="control-label required"><span class="field-name">Select the period
                      you are claiming for</span> <strong class="required">(required)</strong></label>
                  <select required id="claim-period" class="form-control input-lg">
                    <option value=""> Select a claim period</option>
                    <option data-claim-period="1" value="2020-03-15--2020-04-11">Period 1: March 15, 2020, to April 11,
                      2020</option>
                    <option data-claim-period="2" value="2020-04-12--2020-05-09">Period 2: April 12, 2020, to May 9, 2020
                    </option>
                    <option data-claim-period="3" value="2020-05-10--2020-06-06">Period 3: May 10, 2020, to June 6, 2020
                    </option>
                    <option data-claim-period="4" value="2020-06-07--2020-07-04">Period 4: June 7, 2020, to July 4, 2020
                    </option>
                    <option data-claim-period="5" value="2020-07-05--2020-08-01">Period 5: July 5, 2020, to August 1,
                      2020</option>
                    <option data-claim-period="6" value="2020-08-02--2020-08-29">Period 6: August 2, 2020, to August 29,
                      2020</option>
                    <option data-claim-period="7" value="2020-08-30--2020-09-26">Period 7: August 30, 2020, to September 26,
                      2020</option>
                    <option data-claim-period="8" value="2020-09-27--2020-10-24">Period 8: September 27, 2020, to October 24,
                      2020</option>
                    <option data-claim-period="9" value="2020-10-25--2020-11-21">Period 9: October 25, 2020, to November 21,
                      2020</option>
                  </select>
                </div>
              </fieldset>
              <hr class="brdr-bttm">
              <div class="well mrgn-tp-md mrgn-bttm-lg text-muted">
                <h3 class="mrgn-tp-0">Summary of Step 1</h3>
                <ul class="list-unstyled lst-spcd">
                  <li>Claim period is: <span class="h3 claim-period"></span></li>
                </ul>
              </div>
            </li>
            <li>
              <fieldset class="brdr-tp">
                <legend><span class="wb-inv">Step 2: </span>Eligible remuneration for eligible employees</legend>
                <div class="clearfix"></div>
                <p>You may calculate the amount of eligible remuneration (pay) for your eligible employees and basic
                  CEWS using one of the calculators provided. </p>
                <ol class="lst-lwr-alph">
                  <li class="mrgn-bttm-lg">
                    <p class="lead"><span class="wb-inv">Step 2A: </span>Calculate the values using the spreadsheet or
                      online calculator</p>
                    <div class="panel panel-default">
                      <header class="panel-heading">
                        <p class="h4 mrgn-tp-0 panel-title">Calculator options</p>
                      </header>
                      <div class="panel-body">
                        <div class="choose-claim-period alert alert-danger provisional hidden-sm hidden-md hidden-lg">
                          <p>To access the calculator or spreadsheet, you must first <a href="#stp1">select your claim
                              period in step 1</a></p>
                        </div>
                        <div class="row">
                          <div class="col-xs-12">
                            <div class="row wb-eqht-css" data-wb-actionmng='[
		  { "trggroup":"clearFilter", "action": "removeClass", "source": ".btn-cews-cal", "class": "btn-primary" }
	]'>
                              <div class="col-xs-12 col-sm-6 brdr-rght mrgn-bttm-lg wb-eqht-grid">
                                <div class="col-sm-12 hght-inhrt-css">
                                  <div id="calc-pnl" class="eqht-trgt-css">
                                    <p class="h5 mrgn-tp-sm">You may prefer the online calculator if you:</p>
                                    <ul class="mrgn-bttm-0">
                                      <li>can enter employee pay on a weekly basis, and</li>
                                      <li>expect to complete your calculation now</li>
                                    </ul>
                                  </div>
                                  <a href="#cews-cal-options" id="show-online-calc"
                                    class="btn-cews-cal btn btn-default mrgn-tp-md btn-block disabled" data-wb-doaction='[
			{ "action": "run", "trggroup": "clearFilter" },
				{"action": "addClass",
			"source": "#cews-cal-opt1", "class": "hidden"}, {"action": "removeClass",
			"source": "#cews-cal-opt2", "class": "hidden"}, { "action": "addClass", "class": "btn-primary" }
	]'>Online calculator</a>
                                </div>
                              </div>
                              <div id="calc-separator"
                                class="col-xs-1 col-sm-12 pstn-tp-sm pstn-lft-sm text-center mrgn-bttm-lg"><span
                                  class="fa-stack fa-fw text-muted"> <span
                                    class="fas fa-circle fa-stack-2x"></span><span
                                    class="fa-stack-1x fa-inverse">or</span></span></div>
                              <div class="col-xs-12 col-sm-6 mrgn-bttm-lg wb-eqht-grid">
                                <div class="col-sm-12 hght-inhrt-css">
                                  <div class="eqht-trgt-css">
                                    <p class="h5 mrgn-tp-sm">Choose the spreadsheet if you:</p>
                                    <ul class="mrgn-bttm-0">
                                      <li>want to enter pay on a bi-weekly basis</li>
                                      <li>want to save your calculation and come back to it later, or</li>
                                      <li>weren’t operating for all or part of January and February 2020 but use those
                                        months for your baseline revenue</li>
                                    </ul>
                                  </div>
                                  <a href="#cews-cal-options"
                                    class="btn-cews-cal btn btn-default mrgn-tp-md btn-block disabled" data-wb-doaction='[
		{ "action": "run", "trggroup": "clearFilter" },	
		{"action": "removeClass",
			"source": "#cews-cal-opt1", "class": "hidden"}, {"action": "addClass",
			"source": "#cews-cal-opt2", "class": "hidden"}, { "action": "addClass", "class": "btn-primary" }
	]'>Calculation spreadsheet</a>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="choose-claim-period alert alert-danger provisional hidden-xs">
                          <p>To access the calculator or spreadsheet, you must first <a href="#stp1">select your claim
                              period in step 1</a></p>
                        </div>
                      </div>
                    </div>
                    <div class="mrgn-tp-lg">
                      <p class="wb-inv" id="cews-cal-options">Online calculator or spreadsheet</p>
                      <div id="cews-cal-opt1" class="hidden panel panel-primary panel-body" aria-live="polite">
                        <p class="h4 mrgn-tp-0">Calculation spreadsheet </p>
                        <div class="alert alert-warning provisional">
                          <p>Please check that you made your calculations with the most recent version.</p>
                        </div>
                        <div id="cal-sprdsht-none">
                          <p class="mrgn-bttm-0">
                            <button class="btn btn-primary btn-lg" disabled>Download the spreadsheet (Excel)</button>
                            <br>
                            Please select a claim period to download the spreadsheet</p>
                        </div>
                        <div id="cal-sprsht-p5" class="hidden">
                          <p class="mrgn-bttm-0"><a href="cews-calculation-p5-6.xlsx"
                              class="btn btn-primary btn-lg">Download the spreadsheet for period 5 to 6 (Excel)</a></p>
                          <p class="small mrgn-bttm-0">Current version: 2020-5</p>
                          <details class="small mrgn-bttm-lg">
                            <summary>Version updates</summary>
                            <div class="table-responsive">
                              <table class="table small">
                                <caption class="wb-inv">
                                  Version updates
                                </caption>
                                <thead>
                                  <tr>
                                    <th scope="col">Release<br class="visible-xs">
                                      date</th>
                                    <th scope="col">Version</th>
                                    <th scope="col">Description</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr>
                                    <td><time datetime="2020-08-21 11:00"><span class="nowrap">2020-08-21</span><br>
                                        <span class="nowrap">11:00:00 (EDT)</span></time></td>
                                    <td class="nowrap">Version<br class="visible-xs">
                                      2020-5</td>
                                    <td>
                                      <ul>
                                        <li>Changed negative revenue reduction amounts for line c1 of the application
                                        </li>
                                        <li>Applies safe harbour rule when the revenue drop is exactly 30.00% (unless
                                          your revenue drop is exactly 30.00%, this will not affect your calculation)
                                        </li>
                                      </ul>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td><time datetime="2020-08-19 12:30"><span class="nowrap">2020-08-19</span><br>
                                        <span class="nowrap">12:30:00 (EDT)</span></time></td>
                                    <td class="nowrap">Version<br class="visible-xs">
                                      2020-4</td>
                                    <td>
                                      <ul>
                                        <li>Added capability to extend formulas for more than 2500 employees</li>
                                        <!--li>Corrected maximum bi-weekly amount (Step 2b) for non-arm’s length employees when the employer revenue reduction is under 30% for the period</li-->
                                      </ul>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td><time datetime="2020-08-17 17:30"><span class="nowrap">2020-08-17</span><br>
                                        <span class="nowrap">17:30:00 (EDT)</span></time></td>
                                    <td class="nowrap">Version<br class="visible-xs">
                                      2020-3</td>
                                    <td>
                                      <ul>
                                        <li>Corrected calculation issue of the Base Rate when businesses were using the
                                          alternate baseline calculation method and did not carry on business for the
                                          entirety of January to February</li>
                                        <!--li>Corrected maximum bi-weekly amount (Step 2b) for non-arm’s length employees when the employer revenue reduction is under 30% for the period</li-->
                                      </ul>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td><time datetime="2020-08-13 10:00"><span class="nowrap">2020-08-13</span><br>
                                        <span class="nowrap">10:00:00 (EDT)</span></time></td>
                                    <td class="nowrap">Version<br class="visible-xs">
                                      2020-2</td>
                                    <td>
                                      <ul>
                                        <li>Corrected eligibility validation of employees with 14 or more days gap in
                                          employment for periods 5+</li>
                                        <li>Updated compatibility with older versions of Excel</li>
                                      </ul>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td><time datetime="2020-08-11 08:00"><span class="nowrap">2020-08-11</span><br>
                                        <span class="nowrap">08:00:00 (EDT)</span></time></td>
                                    <td class="nowrap">Version<br class="visible-xs">
                                      2020-1</td>
                                    <td>
                                      <ul>
                                        <li>Initial worksheet</li>
                                      </ul>
                                    </td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </details>
                        </div>
                        <div id="cal-sprdsht-p1-4" class="hidden">
                          <p class="mrgn-bttm-0"><a href="cews-calculation-p1-4.xlsx"
                              class="btn btn-primary btn-lg">Download the spreadsheet for period 1 to 4 (Excel)</a></p>
                          <p class="small mrgn-bttm-0">Current version: 2020-9</p>
                          <details class="small">
                            <summary>Version updates</summary>
                            <div class="table-responsive">
                              <table class="table small">
                                <caption class="wb-inv">
                                  Version updates
                                </caption>
                                <thead>
                                  <tr>
                                    <th scope="col">Release<br class="visible-xs">
                                      date</th>
                                    <th scope="col">Version</th>
                                    <th scope="col">Description</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr>
                                    <td><time datetime="2020-08-19 12:30"><span class="nowrap">2020-08-19</span><br>
                                        <span class="nowrap">12:30:00 (EDT)</span></time></td>
                                    <td class="nowrap">Version<br class="visible-xs">
                                      2020-9</td>
                                    <td>
                                      <ul>
                                        <li>Added capability to extend formulas for more than 2500 employees</li>
                                      </ul>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td class="nowrap"><time datetime="2020-08-14 11:45"><span
                                          class="nowrap">2020-08-14</span> <br>
                                        <span class="nowrap">11:45:00 (EDT)</span></time></td>
                                    <td class="nowrap">Version<br class="visible-xs">
                                      2020-8</td>
                                    <td>
                                      <ul>
                                        <li>Corrected baseline remuneration options for period 4</li>
                                      </ul>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td class="nowrap"><time datetime="2020-08-13 10:00"><span
                                          class="nowrap">2020-08-13</span> <br>
                                        <span class="nowrap">10:00:00 (EDT)</span></time></td>
                                    <td class="nowrap">Version<br class="visible-xs">
                                      2020-7</td>
                                    <td>
                                      <ul>
                                        <li>Fixed formula reference for weekly tab</li>
                                        <li>Updated compatibility with older versions of Excel</li>
                                      </ul>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td class="nowrap"><time datetime="2020-08-11 08:00"><span
                                          class="nowrap">2020-08-11</span> <br>
                                        <span class="nowrap">08:00:00 (EDT)</span></time></td>
                                    <td class="nowrap">Version<br class="visible-xs">
                                      2020-6</td>
                                    <td>
                                      <ul>
                                        <li>New options for period to use for employee baseline pay</li>
                                        <li>New revenue drop calculation feature for eligibility</li>
                                        <li>Step by step tabs</li>
                                      </ul>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td class="nowrap"><time datetime="2020-06-25 17:30"><span
                                          class="nowrap">2020-06-25</span> <br>
                                        <span class="nowrap">17:30:00 (EDT)</span></time></td>
                                    <td class="nowrap">Version<br class="visible-xs">
                                      2020-5</td>
                                    <td>
                                      <ul>
                                        <li>Add period 4</li>
                                      </ul>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td class="nowrap"><time datetime="2020-04-27 16:15"><span
                                          class="nowrap">2020-04-27</span> <br>
                                        <span class="nowrap">16:15:00 (EDT)</span></time></td>
                                    <td class="nowrap">Version<br class="visible-xs">
                                      2020-4</td>
                                    <td>
                                      <ul>
                                        <li>Text updates (change does not affect calculation)</li>
                                      </ul>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td class="nowrap"><time datetime="2020-04-24 19:15"><span
                                          class="nowrap">2020-04-24</span> <br>
                                        <span class="nowrap">19:15:00 (EDT)</span></time></td>
                                    <td class="nowrap">Version<br class="visible-xs">
                                      2020-3</td>
                                    <td>
                                      <ul>
                                        <li>Batch rows moved to a separate sheet</li>
                                        <li>Layout updates to make the spreadsheet easier to complete</li>
                                        <li>More detailed instructions on how to input amounts and avoid errors</li>
                                        <li>Rounding made more accurate</li>
                                      </ul>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td class="nowrap"><time datetime="2020-04-21 16:12"><span
                                          class="nowrap">2020-04-22</span> <br>
                                        <span class="nowrap">12:45:00 (EDT)</span></time></td>
                                    <td class="nowrap">Version<br class="visible-xs">
                                      2020-2</td>
                                    <td>
                                      <ul>
                                        <li>On the “Instructions and results” worksheet, the "Total Gross Payroll" label
                                          has
                                          been renamed to "Total eligible remuneration", so it matches the corresponding
                                          web
                                          application form label</li>
                                      </ul>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td><time datetime="2020-04-21 20:00"><span class="nowrap">2020-04-21</span><br>
                                        <span class="nowrap">09:30:00 (EDT)</span></time></td>
                                    <td class="nowrap">Version<br class="visible-xs">
                                      2020-1</td>
                                    <td>
                                      <ul>
                                        <li>Initial worksheet</li>
                                      </ul>
                                    </td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </details>
                        </div>
                        <p class="small">(If you don't have Excel, you can open the spreadsheet in free solutions like
                          Google Sheets, Numbers or OpenOffice.)</p>
                        <p><strong>Note:</strong> If you have an employee that also works for a related eligible
                          employer, you may need to manually adjust the information you enter in the spreadsheet. The
                          combined total CEWS amount that can be claimed for that employee between yourself and any
                          related eligible employers for each week can't exceed $847. A related eligible employer is
                          any eligible employer that you do not deal with on an arm’s-length basis.</p>
                        <details>
                          <summary>Example of an adjustment for an employee working for related entities</summary>
                          <p>Westside Restaurant Ltd. (WRL) and Eastside Bar Ltd. (EBL) are both owned by the same
                            person. Mary works full time at WRL but also works weekends at EBL. Mary earns $1000 per
                            week at WRL and another $300 per week at EBL.</p>
                          <p>Using the calculation spreadsheet, WRL determines the CEWS amount related to Mary for the
                            week is $750 (75% of $1000). When EBL uses the calculation spreadsheet it shows a CEWS
                            amount of $225 (75% of $300) for Mary. However, the total of those two amounts ($750 +
                            $225) is $975 – which exceeds the maximum of $847 by $128.</p>
                          <p>The claim amount of WRL or EBL will need to be manually reduced by a total of $128 so
                            that the total CEWS amount related to Mary does not exceed the $847 maximum for that week.
                          </p>
                        </details>
                      </div>
                      <div id="cews-cal-opt2" class="hidden panel panel-primary panel-body" aria-live="polite">
                        <p class="h4 mrgn-tp-0">Online calculator</p>
                        <fieldset class="brdr-0 hidden" id="rate-reduction">
                          <legend class="mrgn-bttm-0">Calculate your revenue drop and subsidy rate</legend>
                          <p><a class="wb-lbx" role="button" aria-controls="baseline-optns"
                              href="#baseline-optns">Compare the baseline revenue <span class="nowrap">options<span
                                  class="mrgn-lft-sm far fa-question-circle"></span></span></a></p>
                          <div class="wb-fieldflow" data-wb-fieldflow='{"isoptional": true, "noForm": true }'>
                            <p>Which baseline revenue comparison option will you use for this claim (and all claims for
                              periods 5 through 9)?</p>
                            <ul>
                              <li data-wb-fieldflow='{"action": "toggle", "toggle": "#alt-bl-no", "live": true}'>
                                Previous month in 2019 (for example, July 2019 to compare to current claim
                                period of July 2020)</li>
                              <li data-wb-fieldflow='{"action": "toggle", "toggle": "#alt-bl-yes", "live": true}'>
                                Average of January and February 2020 (alternative baseline revenue)</li>
                            </ul>
                          </div>
                        </fieldset>
                        <div class="hidden" id="alt-bl-no">
                          <p><strong>Determine your subsidy rate for the claim period</strong></p>
                          <fieldset>
                            <legend class="mrgn-bttm-0">Enter your eligible revenue for the following months</legend>
                            <p><a class="wb-lbx" role="button" aria-controls="eligible-rev"
                                href="#eligible-rev">Eligible revenue<span
                                  class="mrgn-lft-sm far fa-question-circle"></span></a></p>
                            <p class="small text-muted mrgn-tp-lg" aria-hidden="true">Do not include <strong>spaces,
                                commas,</strong> or a <strong>dollar sign</strong></p>
                            <div class="row">
                              <div class="col-md-6 brdr-rght">
                                <p><strong>2019 revenue</strong></p>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2019-04-no">April 2019<span class="wb-inv">
                                      (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2019-04-no" id="2019-04-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2019-05-no">May 2019<span class="wb-inv">
                                      (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2019-05-no" id="2019-05-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2019-06-no">June 2019<span class="wb-inv">
                                      (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2019-06-no" id="2019-06-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2019-07-no">July 2019<span class="wb-inv">
                                      (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2019-07-no" id="2019-07-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2019-08-no">August 2019<span
                                      class="wb-inv"> (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2019-08-no" id="2019-08-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2019-09-no">September 2019<span
                                      class="wb-inv"> (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2019-09-no" id="2019-09-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2019-10-no">October 2019<span
                                      class="wb-inv"> (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2019-10-no" id="2019-10-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2019-11-no">November 2019<span
                                      class="wb-inv"> (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2019-11-no" id="2019-11-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="col-md-6">
                                <p><strong>2020 revenue</strong></p>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-04-no">April 2020<span class="wb-inv">
                                      (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2020-04-no" id="2020-04-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-05-no">May 2020<span class="wb-inv">
                                      (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2020-05-no" id="2020-05-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-06-no">June 2020<span class="wb-inv">
                                      (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2020-06-no" id="2020-06-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-07-no">July 2020<span class="wb-inv">
                                      (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2020-07-no" id="2020-07-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-08-no">August 2020<span
                                      class="wb-inv"> (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2020-08-no" id="2020-08-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-09-no">September 2020<span
                                      class="wb-inv"> (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2020-09-no" id="2020-09-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-10-no">October 2020<span
                                      class="wb-inv"> (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2020-10-no" id="2020-10-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-11-no">November 2020<span
                                      class="wb-inv"> (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc currency"
                                        name="2020-11-no" id="2020-11-no" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </fieldset>
                          <div class="well text-muted mrgn-tp-md">
                            <h3 class="mrgn-tp-0">Summary of revenue drop and subsidy rates</h3>
                            <ul class="small">
                              <li>Your <strong>current period revenue drop</strong> is <span id="currentRevReduction"
                                  class="h4">0%</span></li>
                              <li>Your <strong>previous period revenue drop</strong> is <span id="priorRevReduction"
                                  class="h4">0%</span></li>
                              <li class="safe-harbour-hide">Because the higher of these revenue drops is <span
                                  class="h4 mrgn-tp-0 rev-reduc-base">0%</span>, your base rate is <span
                                  class="h4 mrgn-tp-0 base-rate">0%</span></li>
                              <li class="mrgn-bttm-md"><span class="safe-harbour-hide">Because your</span><span
                                  class="safe-harbour-show hidden">Your</span> <strong>average revenue drop for the
                                  previous three months</strong> is <strong><span class="rev-drop-top-up h4">0%
                                    <!--average of 3 months 2019 divided by 3 months in 2020--></span></strong><span
                                  class="safe-harbour-hide">, your top-up rate is <span
                                    class="h4 mrgn-tp-0  top-up-rate">0%</span></span></li>
                            </ul>
                            <hr class="brdr-bttm">
                            <p>Your <strong>overall CEWS rate</strong> <span class="safe-harbour-hide small">(<span
                                  class="base-rate">0%</span> base rate + <span class="top-up-rate">0%</span> top-up
                                rate)</span> for claim period <span class="claim-period-no">(choose a claim
                                period)</span> is <span class="h3 mrgn-tp-0 badge mrgn-bttm-0" id="cews-rate">0%</span>
                            </p>
                            <p class="safe-harbour-show hidden mrgn-lft-md small">You qualify for the “safe harbour”
                              rate of 75% because your revenue drop in the current or previous period was at least 30%.
                            </p>
                          </div>
                        </div>
                        <div class="hidden" id="alt-bl-yes">
                          <p><strong>Determine your subsidy rate for the claim period</strong></p>
                          <fieldset>
                            <legend class="mrgn-bttm-0">Enter your eligible revenue for the following months</legend>
                            <p><a class="wb-lbx" role="button" aria-controls="eligible-rev"
                                href="#eligible-rev">Eligible revenue<span
                                  class="mrgn-lft-sm far fa-question-circle"></span></a></p>
                            <p class="small text-muted  mrgn-tp-lg" aria-hidden="true">Do not include <strong>spaces,
                                commas,</strong> or a <strong>dollar sign</strong></p>

                            <div class="row">
                              <div class="col-md-6">
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-01-yes">January 2020<span
                                      class="wb-inv"> (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc-alt currency"
                                        name="2020-01-yes" id="2020-01-yes" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-02-yes">February 2020<span
                                      class="wb-inv"> (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc-alt currency"
                                        name="2020-02-yes" id="2020-02-yes" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-04-yes">April 2020<span
                                      class="wb-inv"> (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc-alt currency"
                                        name="2020-04-yes" id="2020-04-yes" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-05-yes">May 2020<span class="wb-inv">
                                      (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc-alt currency"
                                        name="2020-05-yes" id="2020-05-yes" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-06-yes">June 2020<span class="wb-inv">
                                      (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc-alt currency"
                                        name="2020-06-yes" id="2020-06-yes" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-07-yes">July 2020<span class="wb-inv">
                                      (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc-alt currency"
                                        name="2020-07-yes" id="2020-07-yes" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-08-yes">August 2020<span
                                      class="wb-inv"> (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc-alt currency"
                                        name="2020-08-yes" id="2020-08-yes" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-09-yes">September 2020<span
                                      class="wb-inv"> (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc-alt currency"
                                        name="2020-09-yes" id="2020-09-yes" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-10-yes">October 2020<span
                                      class="wb-inv"> (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc-alt currency"
                                        name="2020-10-yes" id="2020-10-yes" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label class="col-sm-6 control-label" for="2020-11-yes">November 2020<span
                                      class="wb-inv"> (do not include a
                                      dollar sign, spaces or commas)</span></label>
                                  <div class="col-sm-6">
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right cews-rate-calc-alt currency"
                                        name="2020-11-yes" id="2020-11-yes" size="10" placeholder="0.00">
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </fieldset>
                          <div class="well text-muted mrgn-tp-md">
                            <h3 class="mrgn-tp-0">Summary of revenue drop and subsidy rates</h3>
                            <ul class="small">
                              <li>Your <strong>current period revenue drop</strong> is <span
                                  id="currentRevReduction-alt" class="h4">0%</span></li>
                              <li>Your <strong>previous period revenue drop</strong> is <span id="priorRevReduction-alt"
                                  class="h4">0%</span></li>
                              <li class="safe-harbour-hide">Because the higher of these revenue drops is <span
                                  class="h4 rev-reduc-alt-base">0%</span>, your base rate is <span
                                  class="h4 mrgn-tp-0  base-rate-alt">0%</span></li>
                              <li class="mrgn-bttm-md"><span class="safe-harbour-hide">Because your</span><span
                                  class="safe-harbour-show hidden">Your</span> <strong>average revenue drop for the
                                  previous three months</strong> is <span class="rev-drop-top-up-alt h4">0%
                                  <!--average of 3 months 2019 divided by 3 months in 2020--></span><span
                                  class="safe-harbour-hide">, your top-up rate is <span
                                    class="h4 mrgn-tp-0 top-up-rate-alt">0%</span></span></li>
                            </ul>
                            <hr class="brdr-bttm">
                            <p>Your <strong>overall CEWS rate</strong> <span class="safe-harbour-hide small">(<span
                                  class="base-rate-alt">0%</span> base rate + <span class="top-up-rate-alt">0%</span>
                                top-up rate)</span> for claim period <span class="claim-period-no">(choose a claim
                                period)</span> is <span class="h3 mrgn-tp-0 badge mrgn-bttm-0"
                                id="cews-rate-alt">0%</span></p>
                            <p class="safe-harbour-show hidden mrgn-lft-md small">You qualify for the “safe harbour”
                              rate of 75% because your revenue drop in the current or previous period was at least 30%.
                            </p>
                          </div>
                        </div>
                        <fieldset id="employees">
                          <legend>Calculate your employee wages</legend>
                          <p>Include all your eligible employees.</p>
                          <p><strong>Note:</strong> If you want to change your revenue information above, do that step
                            before you begin calculating employee wages.</p>
                          <fieldset class="panel panel-default" id="emp-1">
                            <legend class="col-xs-7 col-sm-9 mrgn-tp-md"><span class="fas fa-user"></span>
                              Eligible employee <span class="employeeNumber">1</span></legend>
                              <button class="col-xs-4 col-sm-2 btn btn-xs btn-danger pull-right rm-emp hidden mrgn-rght-md mrgn-tp-md" type="button">Remove</button>
                            <div class="panel-body">
			<div class="form-group">
                                <label for="ee-name-1">Employee name or alias<span class="wb-inv"> (use a first name or nickname)</span></label>
					<input type="text" class="form-control input-lg text-right" id="ee-name-1">
					<p class="small text-muted" aria-hidden="true">Use a first name or nickname</p>
                              </div>	    
                              <div class="form-group">
                                <label for="arms-1">Is employee at arm's length?</label>
                                <p><a class="wb-lbx arms-length-def" role="button" aria-controls="armslength"
                                    href="#armslength">Arm's
                                    length definition<span class="mrgn-lft-sm far fa-question-circle"></span></a></p>
                                <select class="form-control" id="arms-1" data-updates="emp-arms-1">
                                  <option value="Yes">Yes</option>
                                  <option value="No">No</option>
                                </select>
                              </div>
                              <hr>
                              <div class="form-group">
                                <label for="baseline-1">Average weekly pre-crisis (baseline) pay<span class="wb-inv">
                                    (do not include a
                                    dollar sign, spaces or commas)</span></label>
                                <p><a class="wb-lbx baseline-rem-def" role="button" aria-controls="baseline-rem"
                                    href="#baseline-rem">Choose how to determine pre-crisis <span
                                      class="nowrap">pay<span
                                        class="far fa-question-circle mrgn-lft-sm"></span></span></a></p>
                                <div class="input-group col-md-5"> <span class="input-group-addon">$</span>
                                  <input type="number" class="form-control input-lg text-right currency" id="baseline-1"
                                    data-updates="emp-base-1" placeholder="0.00">
                                </div>
                                <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces,
                                    commas,</strong> or a <strong>dollar sign</strong></p>
                              </div>
                              <fieldset>
                                <legend class="mrgn-bttm-0">Eligible remuneration (pay) in respect of the claim period
                                  <span class="claim-period"></span> </legend>
                                <p><a class="wb-lbx pay-claim-def" role="button" aria-controls="pay-claim"
                                    href="#pay-claim">Claim period pay per week<span class="emp-lv hidden"> and active
                                      employees or employees on leave with pay</span>&nbsp;<span
                                      class="far fa-question-circle"></span></a></p>
                                <div class="form-group row mrgn-tp-lg mrgn-bttm-0">
                                  <div class="col-md-3">
                                    <label for="wkone-1">Week one<span class="wb-inv"> (do not include a
                                        dollar sign, spaces or commas)</span></label>
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right emp-wkly-wage-1 currency"
                                        id="wkone-1" placeholder="0.00" data-updates="w1-amt-1">
                                    </div>
                                    <div class="checkbox emp-lv hidden">
                                      <label for="wkone-cb-1" class="emp-lv">
                                        <input id="wkone-cb-1" type="checkbox" value="">
                                        Leave
                                        with pay<span class="wb-inv"> in week one</span></label>
                                    </div>
                                  </div>
                                  <div class="col-md-3">
                                    <label for="wktwo-1">Week two<span class="wb-inv"> (do not include a
                                        dollar sign, spaces or commas)</span></label>
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right emp-wkly-wage-1 currency"
                                        id="wktwo-1" placeholder="0.00" data-updates="w2-amt-1">
                                    </div>
                                    <div class="checkbox emp-lv hidden">
                                      <label for="wktwo-cb-1" class="emp-lv">
                                        <input id="wktwo-cb-1" type="checkbox" value="">
                                        Leave
                                        with pay<span class="wb-inv"> in week two</span></label>
                                    </div>
                                  </div>
                                  <div class="col-md-3">
                                    <label for="wkthree-1">Week three<span class="wb-inv"> (do not include a
                                        dollar sign, spaces or commas)</span></label>
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right emp-wkly-wage-1 currency"
                                        id="wkthree-1" placeholder="0.00" data-updates="w3-amt-1">
                                    </div>
                                    <div class="checkbox emp-lv hidden">
                                      <label for="wkthree-cb-1" class="emp-lv">
                                        <input id="wkthree-cb-1" type="checkbox" value="">
                                        Leave with pay<span class="wb-inv"> in week three</span></label>
                                    </div>
                                  </div>
                                  <div class="col-md-3">
                                    <label for="wkfour-1">Week four<span class="wb-inv"> (do not include a
                                        dollar sign, spaces or commas)</span></label>
                                    <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                      <input type="number" class="form-control text-right emp-wkly-wage-1 currency"
                                        id="wkfour-1" placeholder="0.00" data-updates="w4-amt-1">
                                    </div>
                                    <div class="checkbox emp-lv hidden">
                                      <label for="wkfour-cb-1" class="emp-lv">
                                        <input id="wkfour-cb-1" type="checkbox" value="">
                                        Leave
                                        with pay<span class="wb-inv"> in week four</span></label>
                                    </div>
                                  </div>
                                </div>
                                <p class="small text-muted mrgn-bttm-0" aria-hidden="true">Do not include
                                  <strong>spaces, commas,</strong> or a <strong>dollar sign</strong></p>
                              </fieldset>
                            </div>
                            <footer class="panel-footer">
                              <details open>
                                <summary>Calculation summary for <span class="ee-name-1">employee <span class="employeeNumber">1</span></span>
                                </summary>
                                <table class="table table-condensed small text-muted" id="emp-smry-1">
                                  <caption class="wb-inv">
                                    Calculation summary for employee <span class="employeeNumber">1</span>
                                  </caption>
                                  <thead>
                                    <tr>
                                      <th scope="col">Week</th>
                                      <th scope="col">Calculated amount</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr>
                                      <td>Week one</td>
                                      <td data-updates="amt-ttl-1" id="w1-amt-1">$0</td>
                                    </tr>
                                    <tr>
                                      <td>Week two</td>
                                      <td data-updates="amt-ttl-1" id="w2-amt-1">$0</td>
                                    </tr>
                                    <tr>
                                      <td>Week three</td>
                                      <td data-updates="amt-ttl-1" id="w3-amt-1">$0</td>
                                    </tr>
                                    <tr>
                                      <td>Week four</td>
                                      <td data-updates="amt-ttl-1" id="w4-amt-1">$0</td>
                                    </tr>
                                  </tbody>
                                  <tfoot>
                                    <tr>
                                      <td>4-week total</td>
                                      <td id="amt-ttl-1" data-updated-by="emp-wkly-wage-1">$0</td>
                                    </tr>
                                  </tfoot>
                                </table>
                                <table id="emp-no-elgbl-1" class="table table-condensed small text-muted hidden">
                                  <thead>
                                    <tr>
                                      <th scope="col">Week</th>
                                      <th scope="col">Calculated amount</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr>
                                      <td colspan="2">This employee is not eligible for this claim period</td>
                                    </tr>
                                  </tbody>
                                </table>
                              </details>
                            </footer>
                          </fieldset>
                          <p class="mrgn-bttm-xl">
                            <button class="btn btn-default" type="button" id="addemp"><span
                                class="fas fa-plus-circle"></span> Add
                              another employee</button>
                          </p>
                        </fieldset>
                        <p class="h3 mrgn-tp-sm brdr-tp"><span class="fas fa-users"></span> Results for employees</p>
                        <ul class="list-unstyled">
                          <li class="mrgn-tp-md"><a href="#ee-calculation-table" aria-controls="ee-calculation-table"
                              class="wb-lbx lbx-modal btn btn-default" role="button" id="showEmpTable">Review, download
                              and print employee calculations</a></li>
                          <li class="mrgn-tp-md">
                            <button type="button" id="transfer-data" class="btn btn-primary">Calculate and send data to the
                              form below (into Step 2b)</button>
                          </li>
                        </ul>
                      </div>
                    </div>
                    <section id="ee-calculation-table"
                      class="mfp-hide modal-dialog modal-content overlay-def wb-popup-full">
                      <header class="modal-header">
                        <h2 class="modal-title">Remuneration calculations for claim period <span
                            class="claim-period"></span></h2>
                      </header>
                      <div class="modal-body">
                        <p class="mrgn-bttm-md">
                          <button type="button" class="btn btn-default hidden-print toCSV"><span
                              class="fas fa-download"></span> Download the
                            following table as spreadsheet file (CSV)</button>
                        </p>
                        <div class="table-responsive">
                          <table class="table table-bordered table-condensed small" id="dataset-filter"
                            summary="Remuneration calculations for claim period">
                            <thead>
                              <tr>
                                <th>Eligible employees (EE)</th>
                                <th>Arm's length</th>
                                <th>Pre-crisis pay</th>
                                <th>Weekly gross pay for week 1</th>
                                <th>Weekly gross pay for week 2</th>
                                <th>Weekly gross pay for week 3</th>
                                <th>Weekly gross pay for week 4</th>
                                <th>Calculated basic CEWS amount</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr id="emp1">
                                <td>
                                  <span class="ee-name-1">Employee 1</span>
                                </td>
                                <td id="emp-arms-1"></td>
                                <td id="emp-base-1"></td>
                                <td data-updated-by="wkone-1"></td>
                                <td data-updated-by="wktwo-1"></td>
                                <td data-updated-by="wkthree-1"></td>
                                <td data-updated-by="wkfour-1"></td>
                                <td id="emp-ttl-1"></td>
                              </tr>
                            </tbody>
                            <tfoot>
                              <tr>
                                <td class="nowrap">Total EEs: <span class="numEmps"></span></td>
                                <td><span class="wb-inv">-</span></td>
                                <td><span class="wb-inv">-</span></td>
                                <td><span class="wb-inv">-</span></td>
                                <td><span class="wb-inv">-</span></td>
                                <td><span class="wb-inv">-</span></td>
                                <td><span class="wb-inv">-</span></td>
                                <td><span>All EE total: <span class="total"></span></span></td>
                              </tr>
                            </tfoot>
                          </table>
                        </div>
                        <ul class="list-inline">
                          <li>
                            <button onclick="window.print()" class="btn btn-success btn-lg hidden-print"><span
                                class="glyphicon glyphicon-print"></span> Print this summary</button>
                          </li>
                          <li class="pull-right">
                            <button title="Close overlay" class="btn btn-sm btn-default pull-right popup-modal-dismiss"
                              type="button">Close<span class="wb-inv"> overlay</span></button>
                          </li>
                        </ul>
                      </div>
                      <div class="modal-footer hidden"> </div>
                    </section>
                  </li>
                  <li>
                    <p class="lead"><span class="wb-inv">Step 2B: </span>Enter the values from the online calculator or
                      spreadsheet</p>
                    <p>If you used the spreadsheet, refer to the <strong>instructions and results</strong> sheet for
                      the final values.</p>
                    <div class="row mrgn-tp-md">
                      <div class="mrgn-lft-lg mrgn-rght-md">
                        <!--For periods 1 to 4 //-->
                        <div class="form-group p14" id="ee-p1-4">
                          <label class="control-label required" for="p2c-ee"><span class="field-name">Total number of
                              eligible employees<span class="wb-inv"> (do not include spaces or commas)</span></span>
                            <strong class="required">(required)</strong> </label>
                          <div class="row">
                            <div class="col-md-3">
                              <input required type="number" class="form-control input-lg text-right currency"
                                id="p2c-ee">
                            </div>
                          </div>
                          <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces</strong> or
                            <strong>commas</strong></p>
                        </div>

                        <!--For periods 5 to 9 //-->
                        <div class="form-group hidden p59" id="ee-p5-9">
                          <div class="row">
                            <div class="col-sm-6">
                              <label class="control-label required" for="p2c-ee-alt1"><span class="field-name">Eligible
                                  active employees<span class="wb-inv"> (do not include spaces or commas)</span></span>
                                <strong class="required">(required)</strong> </label>
                              <div class="row">
                                <div class="col-md-6">
                                  <input required type="number" class="form-control input-lg text-right currency"
                                    id="p2c-ee-alt1">
                                </div>
                              </div>
                            </div>
                            <div class="col-sm-6">
                              <label class="control-label required" for="p2c-ee-alt2"><span class="field-name">Eligible
                                  employees on leave with pay<span class="wb-inv"> (do not include spaces
                                    or commas)</span></span> <strong class="required">(required)</strong> </label>
                              <div class="row">
                                <div class="col-md-6">
                                  <input required type="number" class="form-control input-lg text-right currency"
                                    id="p2c-ee-alt2">
                                </div>
                              </div>
                            </div>
                          </div>
                          <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces</strong> or
                            <strong>commas</strong></p>
                        </div>
                        <div class="form-group">
                          <label class="control-label required" for="p2c-pyrl"><span class="field-name">Total eligible
                              remuneration paid to these employees during this claim period<span class="wb-inv"> (do
                                not include a dollar sign, spaces or commas)</span></span> <strong
                              class="required">(required)</strong> </label>
                          <div class="input-group col-md-5"> <span class="input-group-addon input-sm">$</span>
                            <input required type="number" class="form-control input-lg text-right currency"
                              id="p2c-pyrl">
                          </div>
                          <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces, commas,</strong>
                            or a <strong>dollar sign</strong></p>
                        </div>
                        <!--For periods 5 - 9 only//-->
                        <div class="hidden p59" id="p2b-rev">
                          <div class="form-group">
                            <label for="p2b-c1" class="control-label required"><span class="field-name">Revenue drop for
                                the current period<span class="wb-inv"> (do
                                  not include spaces or commas)</span></span> <strong
                                class="required">(required)</strong></label>
                            <div class="input-group col-sm-3">
                              <input type="number" size="10" id="p2b-c1" name="p2b-c1" class="form-control text-right"
                                placeholder="0" min="0" max="100" required>
                              <span class="input-group-addon">%</span></div>
                            <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces</strong> or
                              <strong>commas</strong></p>
                          </div>
                          <div class="form-group">
                            <label for="p2b-c2" class="control-label required"><span class="field-name">Average revenue
                                drop for the previous three months<span class="wb-inv"> (do
                                  not include spaces or commas)</span></span> <strong
                                class="required">(required)</strong></label>
                            <div class="input-group col-sm-3">
                              <input type="number" size="10" id="p2b-c2" name="p2b-c2" class="form-control text-right"
                                placeholder="0" min="0" max="100" required>
                              <span class="input-group-addon">%</span></div>
                            <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces</strong> or
                              <strong>commas</strong></p>
                          </div>
                          <div class="form-group">
                            <label for="p2b-c3" class="control-label required"><span class="field-name">Subsidy rate
                                used for active employees in the calculation of the total
                                basic CEWS<span class="wb-inv"> (do
                                  not include spaces or commas)</span></span> <strong
                                class="required">(required)</strong></label>
                            <div class="input-group col-sm-3">
                              <input type="number" size="10" id="p2b-c3" name="p2b-c3" class="form-control text-right"
                                placeholder="0" min="0" max="100" required>
                              <span class="input-group-addon">%</span></div>
                            <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces</strong> or
                              <strong>commas</strong></p>
                          </div>
                        </div>
                        <div class="form-group">
                          <label class="control-label required" for="p2c-cews"><span class="field-name">Total basic
                              CEWS for these employees during this claim period<span class="wb-inv"> (do not include a
                                dollar sign or commas)</span> </span> <strong class="required">(required)</strong>
                          </label>
                          <p class="text-muted small hidden p59" aria-describedby="p2c-cews" id="p2c-cews-p5-9">This
                            amount includes both the base and top-up amount (if applicable).</p>
                          <div class="input-group col-md-5"> <span class="input-group-addon input-sm">$</span>
                            <input required type="number" class="form-control input-lg text-right currency"
                              id="p2c-cews">
                          </div>
                          <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces, commas,</strong>
                            or a <strong>dollar sign</strong></p>
                        </div>
                      </div>
                    </div>
                  </li>
                </ol>
                <hr class="brdr-bttm">
                <div class="well mrgn-tp-md mrgn-bttm-lg text-muted">
                  <h3 class="mrgn-tp-0">Summary of Step 2</h3>
                  <ul class="list-unstyled lst-spcd">
                    <li id="sum-ee-p1-4" class="p14"> <span class="h3">Line A</span> Number of eligible employees <abbr
                        title="equals" class="brdr-0">=</abbr>
                      <output class="h3 wb-calc nowrap" for="p2c-ee" data-wb-calc='{"expr": "#p2c-ee * 1"}'></output>
                    </li>
                    <li id="sum-ee-active" class="hidden p59"> <span class="h3">Line A</span> Number of eligible active
                      employees <abbr title="equals" class="brdr-0">=</abbr>
                      <output class="h3 wb-calc nowrap" for="p2c-ee-alt1"
                        data-wb-calc='{"expr": "#p2c-ee-alt1 * 1"}'></output>
                    </li>
                    <li id="sum-ee-lwp" class="hidden p59"> <span class="h3">Line AA</span> Number of eligible employees
                      on leave with pay <abbr title="equals" class="brdr-0">=</abbr>
                      <output class="h3 wb-calc nowrap" for="p2c-ee-alt2"
                        data-wb-calc='{"expr": "#p2c-ee-alt1 * 2"}'></output>
                    </li>
                    <li> <span class="h3">Line B</span> Total eligible remuneration paid <abbr title="equals"
                        class="brdr-0">=</abbr>
                      <output class="h3 wb-calc nowrap" for="p2c-pyrl"
                        data-wb-calc='{"expr": "#p2b-pyrl * 1", "format": "currency"}'></output>
                    </li>
                    <li id="sum-rev" class="hidden p59"><span class="h4">Revenue drop and subsidy rate</span>
                      <ul class="list-unstyled mrgn-lft-md">
                        <li><span class="h4">Line c1</span> Revenue drop for the current period <abbr title="equals"
                            class="brdr-0">=</abbr>
                          <output class="h4 wb-calc nowrap" for="p2b-c1"></output>
                        </li>
                        <li><span class="h4">Line c2</span> Average revenue drop for the previous three months <abbr
                            title="equals" class="brdr-0">=</abbr>
                          <output class="h4 wb-calc nowrap" for="p2b-c2"></output>
                        </li>
                        <li><span class="h4">Line c3</span> Subsidy rate used for active employees in the calculation of
                          Line C <abbr title="equals" class="brdr-0">=</abbr>
                          <output class="h4 wb-calc nowrap" for="p2b-c3"></output>
                        </li>
                      </ul>
                    </li>
                    <li> <span class="h3">Line C</span> Basic CEWS (including top-up, if applicable) <abbr
                        title="equals" class="brdr-0">=</abbr>
                      <output class="h3 wb-calc nowrap" for="p2c-cews"
                        data-wb-calc='{"expr": "#p2c-cews * 1", "format": "currency"}'></output>
                    </li>
                  </ul>
                </div>
              </fieldset>
            </li>
            <li>
              <fieldset class="brdr-tp">
                <legend><span class="wb-inv">Step 3: </span>Premiums and contributions</legend>
                <p>Enter the total employer-paid amount of <a href="#contributions" aria-controls="contributions"
                    class="wb-lbx" role="button">premiums or contributions&nbsp;<span
                      class="far fa-question-circle"></span></a> paid
                  on behalf of <a href="#lwp" aria-controls="lwp" class="wb-lbx" role="button">eligible
                    employees on leave with pay&nbsp;<span class="far fa-question-circle"></span></a> during the
                  selected period. Enter
                  $0 if not applicable. </p>
                <div class="mrgn-lft-md">
                  <div class="form-group">
                    <label class="control-label required" for="p3-ei"><span class="field-name">Total EI and QPIP
                        premiums that you paid on salary to eligible employees on leave with pay <small>(for the claim
                          period)</small><span class="wb-inv"> (do not include a dollar sign or commas)</span></span>
                      <strong class="required p3-ee-req">(required)</strong> </label>
                    <div class="input-group col-md-5"> <span class="input-group-addon input-sm">$</span>
                      <input required type="number" class="form-control input-lg text-right currency" id="p3-ei">
                    </div>
                    <p class="small hidden text-danger no-lwp-disclaimer">You have no employees on leave with pay (line AA) during this claim period.</p>
                    <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces, commas,</strong> or a
                      <strong>dollar sign</strong></p>
                  </div>
                  <div class="form-group">
                    <label class="control-label required" for="p3-cpp"><span class="field-name">Total CPP and QPP
                        contributions that you made on salary to eligible employees on leave with pay <small>(for the
                          claim
                          period)</small><span class="wb-inv"> (do not include a dollar sign or commas)</span></span>
                      <strong class="required p3-ee-req">(required)</strong> </label>
                    <div class="input-group col-md-5"> <span class="input-group-addon input-sm">$</span>
                      <input required type="number" class="form-control input-lg text-right currency" id="p3-cpp">
                    </div>
                    <p class="small hidden text-danger no-lwp-disclaimer">You have no employees on leave with pay (line AA) during this claim period.</p>
                    <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces, commas,</strong> or a
                      <strong>dollar sign</strong></p>
                  </div>
                </div>
                <hr class="brdr-bttm">
                <div class="well mrgn-tp-md mrgn-bttm-lg text-muted">
                  <h3 class="mrgn-tp-0">Summary of Step 3</h3>
                  <ul class="list-unstyled lst-spcd">
                    <li> <span class="h3">Line D</span> Employer’s EI and QPIP premiums payable on salary paid to
                      employees on leave with pay <small>(for the claim period)</small> <abbr title="equals"
                        class="brdr-0">=</abbr>
                      <output class="h3 wb-calc nowrap" for="p3-ei"
                        data-wb-calc='{"expr": "#p3-ei * 1", "format": "currency"}'></output>
                    </li>
                    <li> <span class="h3">Line E</span> Employer’s CPP and QPP contributions payable on salary paid to
                      employees on leave with pay <small>(for the claim period)</small> <abbr title="equals"
                        class="brdr-0">=</abbr>
                      <output class="h3 wb-calc nowrap" for="p3-cpp"
                        data-wb-calc='{"expr": "#p3-cpp * 1", "format": "currency"}'></output>
                    </li>
                  </ul>
                </div>
              </fieldset>
            </li>
            <li>
              <fieldset class="mrgn-bttm-lg">
                <legend><span class="wb-inv">Step 4: </span>Deductions</legend>
                <div class="mrgn-lft-md">
                  <div class="form-group">
                    <label class="control-label required" for="p4-tws"><span class="field-name">Amount you
                        calculated for the 10% Temporary Wage Subsidy for Employers <small>(for the claim
                          period)</small> (enter $0 if not applicable)<span class="wb-inv"> (do not include a dollar
                          sign or commas)</span></span> <strong class="required">(required)</strong> </label>
                    <p><a href="#tempwage" aria-controls="tempwage" class="wb-lbx" role="button">10% Temporary Wage
                        Subsidy for Employers amount&nbsp;<span class="far fa-question-circle"></span></a></p>
                    <div class="input-group col-md-5"> <span class="input-group-addon input-sm">$</span>
                      <input required type="number" class="form-control input-lg text-right currency" id="p4-tws">
                    </div>
                    <p id="p4-tws-disclaimer" class="small hidden text-danger">The amount for this claim period is $0
                      because the temporary subsidy has ended.</p>
                    <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces, commas,</strong> or a
                      <strong>dollar sign</strong></p>
                  </div>
                  <div class="form-group">
                    <label class="control-label required" for="p4-wsb"><span class="field-name">Total amount that your
                        eligible employees have received under ESDC’s Work-Sharing benefit program <small>(for the
                          claim period)</small> (enter $0 if not applicable) <span class="wb-inv"> (do not include a
                          dollar sign or commas)</span></span> <strong class="required">(required)</strong> </label>
                    <p><a href="#worksharing" aria-controls="worksharing" class="wb-lbx" role="button">Work-Sharing
                        benefit program amount&nbsp;<span class="far fa-question-circle"></span></a></p>
                    <div class="input-group col-md-5"> <span class="input-group-addon input-sm">$</span>
                      <input required type="number" class="form-control input-lg text-right currency" id="p4-wsb">
                    </div>
                    <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces, commas,</strong> or a
                      <strong>dollar sign</strong></p>
                  </div>
                </div>
                <hr class="brdr-bttm">
                <div class="well mrgn-tp-md mrgn-bttm-lg text-muted">
                  <h3 class="mrgn-tp-0">Summary of Step 4</h3>
                  <ul class="list-unstyled lst-spcd">


                    <li> <span class="h3">Line F</span> 10% Temporary Wage Subsidy for
                      Employers reduction <small>(for the claim period)</small> <abbr title="equals"
                        class="brdr-0">=</abbr>
                      <output class="h3 wb-calc nowrap" for="p4-tws"
                        data-wb-calc='{"expr": "#p4-tws * 1", "format": "currency"}'></output>
                    </li>
                    <li> <span class="h3">Line G</span> Amounts received by eligible employees under ESDC's
                      Work-Sharing benefit program <small>(for the claim period)</small> <abbr title="equals"
                        class="brdr-0">=</abbr>
                      <output class="h3 wb-calc nowrap" for="p4-wsb"
                        data-wb-calc='{"expr": "#p4-wsb * 1", "format": "currency"}'></output>
                    </li>
                  </ul>
                </div>
              </fieldset>
            </li>
            <li>
              <fieldset>
                <legend><span class="wb-inv">Step 5: </span>Get results</legend>
                <p>After completing the four steps above, you can now calculate the results.</p>
                <p>
                  <button id="calculate" class="btn btn-primary btn-lg" type="submit">Calculate your total wage
                    subsidy</button>
                </p>
              </fieldset>
            </li>
          </ol>
        </form>
      </div>
      <div class="panel panel-primary hidden" id="results">
        <header class="panel-heading">
          <h2 class="panel-title">Canada Emergency Wage Subsidy (CEWS) amount to claim</h2>
        </header>
        <div class="panel-body">
          
          <div id="cews-statement">
		  <p class="lead"><strong>Print and keep this record using the print preview button below</strong>. You will need line amounts <strong>A to H</strong> when you complete your online application for CEWS.</p>
       
		  
		  <p>For the claim period of <strong class="claim-period"></strong>: </p>
            <ul class="lst-spcd">
              <li class="p14"> Line A: Number of eligible employees: <strong>
                  <output class="h3 wb-calc nowrap" for="p2c-ee" data-wb-calc='{"expr": "#p2c-ee * 1"}'></output>
                </strong> </li>
		    <li id="sum-ee-active2" class="hidden p59"><strong>Line A:</strong> Number of eligible active employees:
                <output class="h3 wb-calc nowrap" for="p2c-ee-alt1"
                  data-wb-calc='{"expr": "#p2c-ee-alt1 * 1"}'></output>
              </li>
		    <li id="sum-ee-lwp2" class="hidden p59"><strong>Line AA:</strong> Number of eligible employees on leave with pay:
                <output class="h3 wb-calc nowrap" for="p2c-ee-alt2"
                  data-wb-calc='{"expr": "#p2c-ee-alt1 * 2"}'></output>
              </li>
		    <li><strong>Line B:</strong> Total eligible remuneration paid: <strong>
                  <output class="h3 wb-calc nowrap" for="p2c-pyrl"
                    data-wb-calc='{"expr": "#p2b-pyrl * 1", "format": "currency"}'></output>
                </strong> </li>
              <li id="sum-rev2" class="hidden p59">Revenue drop and subsidy rate
                <ul class="list-unstyled mrgn-lft-md">
			<li><strong>Line c1:</strong>
                    Revenue drop for the current period:
                    <output class="h3 wb-calc nowrap" for="p2b-c1"></output>
                  </li>
			<li><strong>Line c2:</strong>
                    Average revenue drop for the previous three months:
                    <output class="h3 wb-calc nowrap" for="p2b-c2"></output>
                  </li>
			<li><strong>Line c3:</strong>
                    Subsidy rate used for active employees in the calculation of Line C:
                    <output class="h3 wb-calc nowrap" for="p2b-c3"></output>
                  </li>
                </ul>
              </li>
		    <li><strong>Line C:</strong> Basic CEWS (including top-up, if applicable): <strong>
                  <output class="h3 wb-calc nowrap" for="p2c-cews"
                    data-wb-calc='{"expr": "#p2c-cews * 1", "format": "currency"}'></output>
                </strong> </li>
		    <li><strong>Line D:</strong> Employer’s EI and QPIP premiums payable on salary paid to employees on leave with pay
                <small>(for
                  the claim period)</small>: <strong>
                  <output class="h3 wb-calc nowrap" for="p3-ei"
                    data-wb-calc='{"expr": "#p3-ei * 1", "format": "currency"}'></output>
                </strong> </li>
		    <li><strong>Line E:</strong> Employer’s CPP and QPP contributions payable on salary paid to employees on leave with pay
                <small>(for the claim period)</small>: <strong>
                  <output class="h3 wb-calc nowrap" for="p3-cpp"
                    data-wb-calc='{"expr": "#p3-cpp * 1", "format": "currency"}'></output>
                </strong> </li>
		    <li><strong>Line F:</strong> 10% Temporary Wage Subsidy for Employers reduction <small>(for the claim
                  period)</small>: <strong>
                  <output class="h3 wb-calc nowrap" for="p4-tws"
                    data-wb-calc='{"expr": "#p4-tws * 1", "format": "currency"}'></output>
                </strong> </li>
		    <li><strong>Line G:</strong> Amounts received by eligible employees under ESDC’s Work-Sharing benefit program <small>(for
                  the claim period)</small>: <strong>
                  <output class="h3 wb-calc nowrap" for="p4-wsb"
                    data-wb-calc='{"expr": "#p4-wsb * 1", "format": "currency"}'></output>
                </strong> </li>
            </ul>
            <div class="alert alert-success provisional">
              <h3>Result</h3>
		    <p><strong>Line H:</strong> The <strong>total amount</strong> you will claim for the CEWS for this period is: <strong>
                  <output class="h3 wb-calc nowrap" for="p2c-cews p3-ei p3-cpp p4-tws p4-wsb"
                    data-wb-calc='{"expr": "#p2c-ee + #p2-pyrl + #p3-ei + #p3-cpp - #p4-tws - #p4-wsb", "format": "currency"}'></output>
                </strong> This amount is subject to verification. </p>
		  
            </div>
          </div>
	
        </div>
        <table class="table" id="cews-statement-table">
          <caption class="h5 mrgn-bttm-0">
            Summary of CEWS calculation
          </caption>
          <tbody>
            <tr>
              <th scope="row" class="h6">Basic CEWS <small class="nowrap">(Line C)</small></th>
              <td class="text-right nowrap"><output class="h6 wb-calc nowrap" for="p2c-cews"
                  data-wb-calc='{"expr": "#p2c-cews * 1", "format": "currency"}'></output></td>
            </tr>
            <tr>
              <th scope="row" class="h6">(add) EI and QPIP share <small class="nowrap">(Line D)</small></th>
              <td class="text-right nowrap">+
                <output class="h6 wb-calc nowrap" for="p3-ei"
                  data-wb-calc='{"expr": "#p3-ei * 1", "format": "currency"}'></output></td>
            </tr>
            <tr>
              <th scope="row" class="h6">(add) CPP and QPP share <small class="nowrap">(Line E)</small></th>
              <td class="text-right nowrap">+
                <output class="h6 wb-calc nowrap" for="p3-cpp"
                  data-wb-calc='{"expr": "#p3-cpp * 1", "format": "currency"}'></output></td>
            </tr>
            <tr>
              <th scope="row" class="h6">(less) 10% Temporary Wage Subsidy for Employers claim <small class="nowrap">(Line
                  F)</small></th>
              <td class="text-right nowrap"><abbr title="negative" class="brdr-0">-</abbr>
                <output class="h6 wb-calc nowrap" for="p4-tws"
                  data-wb-calc='{"expr": "#p4-tws * 1", "format": "currency"}'></output></td>
            </tr>
            <tr>
              <th scope="row" class="h6">(less) Work-Sharing benefit program received <small class="nowrap">(Line G)</small></th>
              <td class="text-right nowrap"><abbr title="negative" class="brdr-0">-</abbr>
                <output class="h6 wb-calc nowrap" for="p4-wsb"
                  data-wb-calc='{"expr": "#p4-wsb * 1", "format": "currency"}'></output></td>
            </tr>
            <tr class="success">
              <th scope="row" class="h6">Your CEWS claim, subject to verification, is <small class="nowrap">(Line H)</small></th>
              <td class="text-right nowrap"><output class="h6 wb-calc nowrap" for="p2c-cews p3-ei p3-cpp p4-tws p4-wsb"
                  data-wb-calc='{"expr": "#p2-pyrl + #p3-ei + #p3-cpp - #p4-tws - #p4-wsb", "format": "currency"}'></output>
              </td>
            </tr>
          </tbody>
        </table>
      <div class="panel-body">
	      <p>You are now ready to <strong>print these amounts</strong> so you can enter them into your wage subsidy application. The data is not saved on this page. If you leave this page without printing you will need to enter your information again.</p>      
	    <p class="hidden-print"><a href="#pp-statement" class="wb-lbx btn btn-default btn-lg"
              role="button"><span class="h3"><span class="glyphicon glyphicon-print"></span> Print preview<span class="wb-inv"> CEWS
		statement</span></span></a></p>	  
	      </div>
      </div>
      <nav class="mrgn-bttm-lg mrgn-tp-lg">
        <h3 class="wb-inv">Document navigation</h3>
        <ul class="pager">
          <li class="next"><a href="how-apply.html" rel="next">How to apply</a></li>
        </ul>
      </nav>
    </section>
    <section id="armslength" class="mfp-hide modal-dialog modal-content overlay-def">
      <header class="modal-header">
        <h2 class="modal-title">Arm's length and non-arm's length</h2>
      </header>
      <div class="modal-body" data-ajax-replace="who-employees.html #nonarm-cntnt">
        <p><a href="who-employees.html#nonarm">Non-arm’s-length and arm’s-length eligible employees</a></p>
      </div>
    </section>
    <section id="contributions" class="mfp-hide modal-dialog modal-content overlay-def">
      <header class="modal-header">
        <h2 class="modal-title">Lines D and E - Employer’s EI, QPIP, CPP, and QPP premiums payable on salary paid to
          employees on leave with pay </h2>
      </header>
      <div class="modal-body" data-ajax-replace="who-employees.html #refund-contrib">
        <p><a href="who-employees.html#leave">Active employees and employees on leave with pay</a></p>
      </div>
    </section>
    <span class="mfp-hide">
      <section id="tempwage" class="modal-dialog modal-content overlay-def">
        <header class="modal-header">
          <h2 class="modal-title">10% Temporary Wage Subsidy for Employers reduction</h2>
        </header>
        <div class="modal-body">
          <p class="lead">Line F –10% Temporary Wage Subsidy for Employers reduction</p>
          <p><strong>For claim periods 5 and later</strong>, the amount for this line will be 0.</p>
          <p><strong>For periods 1 to 4</strong>, you will need to calculate the amount of your 10% Temporary Wage
            Subsidy (a separate
            program) that applies to this CEWS claim period before you enter it at Line F.</p>
          <p>Generally, the 10% Temporary Wage Subsidy for Employers is equal to:</p>
          <p class="mrgn-lft-md"><strong>10% of the remuneration you paid from March 18 to June 19, 2020, up to $1,375
              for
              each eligible employee</strong></p>
          <p>The total maximum of the temporary subsidy is $25,000 per employer.</p>
          <p>CEWS and the 10% Temporary Wage Subsidy for Employers are intended to provide total support of up to 75%,
            not
            75% + 10%. If you are eligible for both wage subsidies for a claim period, any amount you calculate under
            the
            10% Temporary Wage Subsidy for Employers in the period will reduce the amount available for you to claim
            under
            the CEWS in that same period.</p>
          <p>You may choose to have the 10% Temporary Wage Subsidy be less than 10% of the remuneration you paid so that
            you can receive a higher amount of Canada Emergency Wage Subsidy. If you enter 0 as your amount for the 10%
            Temporary Wage Subsidy for Employers in your CEWS application, the CEWS will be determined as if you are
            electing 0% as the prescribed percentage for 10% Temporary Wage Subsidy for Employers, and are requesting
            the
            maximum amount of CEWS instead.</p>
          <p>Read more: <a
              href="/content/canadasite/en/revenue-agency/services/subsidy/temporary-wage-subsidy.html">Temporary Wage
              Subsidy for Employers</a></p>
        </div>
      </section>
    </span>
    <section id="worksharing" class="mfp-hide modal-dialog modal-content overlay-def">
      <header class="modal-header">
        <h2 class="modal-title">Line G - Amounts received by eligible employees under ESDC's Work-Sharing benefit
          program </h2>
      </header>
      <div class="modal-body">
        <div data-ajax-replace="who-employees.html #worksharing-cntnt"><a
            href="who-employees.html#worksharing-cntnt">Eligible employees participating in a Work-Sharing benefit
            program</a></div>
        <p>Enter the total amount received under the Work-Sharing program by your eligible employees during the period
          covered by this claim in the box for line G. </p>
      </div>
    </section>
    <section id="lwp" class="mfp-hide modal-dialog modal-content overlay-def">
      <header class="modal-header">
        <h2 class="modal-title">Active employees and employees on leave with pay</h2>
      </header>
      <div class="modal-body" data-ajax-replace="who-employees.html #leave-cntnt">
        <p><a href="who-employees.html#leave">Active employees and employees on leave with pay</a></p>
      </div>
    </section>
    <section id="pp-statement" class="mfp-hide modal-dialog modal-content overlay-def experimental">
      <header class="modal-header">
        <h2 class="modal-title">Print preview for CEWS statement</h2>
      </header>
      <div class="modal-body">
        <div data-ajax-replace=" #cews-statement"></div>
        <div data-ajax-replace=" #cews-statement-table"></div>
        <ul class="list-inline">
          <li>
            <button onclick="window.print()" class="btn btn-success btn-lg"><span
                class="glyphicon glyphicon-print"></span> Print this statement</button>
          </li>
          <li class="pull-right">
            <button title="Close overlay" class="btn btn-sm btn-default pull-right popup-modal-dismiss"
              type="button">Close<span class="wb-inv"> overlay</span></button>
          </li>
        </ul>
      </div>
      <div class="modal-footer hidden"> </div>
    </section>


    <section id="baseline-optns" class="mfp-hide modal-dialog modal-content overlay-def">
      <header class="modal-header">
        <h2 class="modal-title">Compare the baseline revenue options</h2>
      </header>
      <div class="modal-body">
        <h3 class="mrgn-tp-sm">Baseline revenue and prior reference period options</h3>
        <div data-ajax-replace="how-much-reduction.html #basebaselinecalc-cntnt">
          <p><a href="how-much-reduction.html#basebaselinecalc-cntnt">Baseline revenue and prior reference period
              options</a></p>
        </div>
        <details>
          <summary>Example: Choosing a revenue comparison option</summary>
          <div data-ajax-replace="how-much-reduction.html #rev-drop-example-1-cntnt"> </div>
        </details>
      </div>
    </section>
    <section id="baseline-rem" class="mfp-hide modal-dialog modal-content overlay-def">
      <header class="modal-header">
        <h2 class="modal-title">Pre-crisis pay (baseline remuneration)</h2>
      </header>
      <div class="modal-body" data-ajax-replace="who-employees.html #baselineremuneration-cntnt">
        <p><a href="who-employees.html#baselineremuneration">Pre-crisis pay (baseline remuneration)</a></p>
      </div>
    </section>
    <section id="pay-claim" class="mfp-hide modal-dialog modal-content overlay-def">
      <header class="modal-header">
        <h2 class="modal-title">Claim period pay per week<span class="emp-lv hidden"> and active employees or employees
            on leave with pay</span></h2>
      </header>
      <div class="modal-body">
        <h3>Claim period pay per week</h3>
        <div data-ajax-replace="who-employees.html #week-cntnt">
          <p><a href="who-employees.html#week">Claim period pay per week</a></p>
        </div>
        <div class="emp-lv hidden">
          <h3>Active employees and employees on leave with pay</h3>
          <div data-ajax-replace="who-employees.html #leave-cntnt">
            <p><a href="who-employees.html#leave">Active employees and employees on leave with pay</a></p>
          </div>
        </div>
      </div>
    </section>
    <section id="eligible-rev" class="mfp-hide modal-dialog modal-content overlay-def">
      <header class="modal-header">
        <h2 class="modal-title">Eligible revenue</h2>
      </header>
      <div class="modal-body">
        <p>These months are needed to calculate your revenue drops for the current period, prior period, and top-up
          period, using your chosen baseline.</p>
        <p>Read more about <a href="who-apply.html#eligible-revenue" target="_blank">eligible <span
              class="nowrap">revenue<span class="far fa-window-restore mrgn-lft-sm"></span></span><span class="wb-inv">
              (opens in new window)</span></a></p>
      </div>
    </section>
    <!--This is not relevant for the estimated range output--<p>[Save or copy the result of your calculation to enter when you apply for the benefit.]</p>-->
    <div class="hidden-md hidden-lg"
      data-ajax-replace="/content/canadasite/en/revenue-agency/services/subsidy/emergency-wage-subsidy.html #related-menu">
    </div>
    </section>
    <div id="def-preFooter"></div>
    <!-- Write closure template -->
    <script type="text/javascript">
      var defPreFooter = document.getElementById("def-preFooter");
      defPreFooter.outerHTML = wet.builder.preFooter({
        dateModified: "2020-08-02",
        showPostContent: true,
        showFeedback: true,
        showShare: true
      });
    </script>
  </main>
  <div id="def-footer"></div>
  <!-- Write closure template -->
  <script type="text/javascript">
    var defFooter = document.getElementById("def-footer");
    defFooter.outerHTML = wet.builder.footer({
      showFooter: true,
      showFeatures: true
    });
  </script>
  <!-- Write closure template -->
  <script type="text/javascript">
    document.write(wet.builder.refFooter({
    }));
  </script>
  <script src="https://test.canada.ca/covid-19-guidance/proto/js/alpha-banner.js"></script>
  <script>
    /**
     * EmployeeFormGenerator class
     * used to help creating new employee wage forms based on the chosen pay 
     * schedule
     * 
     */
    var EmployeeFormGenerator = (function () {

      /**
       * Constructor
       * 
       * @param {Int} paySchedule the numeric value of the chosen pay schedule
       */
      function EmployeeFormGenerator(paySchedule) {
        //the payschedule chosen by the user
        this.paySchedule = paySchedule;
        //variables to avoid magic numbers & strings
        this.prefix = "";
        this.numberOfEmployees = 1;
        this.weekly = 1;
        this.biWeekly = 2;
        this.templateId = "emp-1";
        this.armsLengthId = "arms-";
        this.baselineId = "baseline-"
        this.employeeNumberClass = "employeeNumber";
        this.removeablePanelClass = "extra-emp-pnl";
        this.currencyPlaceholderValue = "$0";
        this.weeklySummaryBaseClass = "emp-wkly-wage-1";
        this.weeklySummaryClass = "emp-wkly-wage-";
        this.employeeIndexRegex = /-1$/g;
        this.prefix = this.weeklyPrefix
      }

      /**
       * generateNewEmployeeForm
       * 
       * function called to run the routine to generate the new form
       * 
       * @param {Int} numEmps the number of employee panels currently on the 
       * page
       * 
       * @return {DOMDocumentFragment} the cloned template with ID's and other 
       * attributes updated for use in as a new employee wage form
       */
      EmployeeFormGenerator.prototype.generateNewEmployeeForm = function (numEmps) {
        //update number of employee frames
        this.numberOfEmployees = numEmps;
        //generate another pay form
        var newForm = this.generateNewForm();
        return newForm;
      }

      /**
       * generateNewForm
       * 

       * clone the template DOM element and update the required attributes for 
       * a new employee wage form
       * 
       * @calls EmployeeFormGenerator::updateArmsLengthElementId()
       * @calls EmployeeFormGenerator::updateBaselineWageElementId() to update 
       * the baseline wage element
       * @calls EmployeeFormGenerator::setUpdatesAndUpdatedByData() to update 
       * the data-updates and data-update-by attributes
       * @calls EmployeeFormGenerator::updateInputs() to update the input fields
       * @calls EmployeeFormGenerator::updateTableIds() to update the summary 
       * table cells
       * @calls EmployeeFormGenerator::openAccordion() to open all accordion 
       * elements
       *
       * @return {DOMDocumentFragment} the update DOM fragment to be used as 
       * the new employee wage form
       */
      EmployeeFormGenerator.prototype.generateNewForm = function () {
        var frag = $("#" + this.templateId).clone();
        //update the frame id
        $(frag).attr("id", $(frag).attr("id").replace("-1", "-" + this.numberOfEmployees));
        //add class that will be used to identify panels to remove when the selected pay schedule is changed
        $(frag).addClass(this.removeablePanelClass);
        //update the employee number text
        var numEmps = this.numberOfEmployees;
        $(frag).find("." + this.employeeNumberClass).each(function (e, element) {
          $(element).text(numEmps);
        });
        //add the aria-live=polite attr for screen readers
        $(frag).attr("aria-live", "polite");
        var rmBtn = $(frag).find(".rm-emp");
        $(rmBtn).removeClass("hidden");
        //update the DOM fragment
        this.updateArmsLengthElementId(frag);
        this.updateBaselineWageElementId(frag);
        this.setUpdatesAndUpdatedByData(frag);
        this.updateInputs(frag);
        this.updateTableIds(frag);
        this.openAccordion(frag);
        this.updateSummaryHeading(frag);
        return frag;
      }

      /**
       * updateArmsLengthElementId
       * 
       * update the arms length dropdown element
       * 
       * @param {DOMDocumentFragment} frag the cloned template
       */
      EmployeeFormGenerator.prototype.updateArmsLengthElementId = function (frag) {
        var armsLengthElement = $(frag).find(
          "#" + this.armsLengthId + "1"
        );
        $(armsLengthElement).attr("id", $(armsLengthElement).attr("id").replace(this.employeeIndexRegex, "-" + this.numberOfEmployees));
        $(armsLengthElement).first("option").attr("selected", true);
      }

      /**
       * updateBaselineWageElementId
       * 
       * update the baseline wage input id and reset the value
       * 
       * @param {DOMDocumentFragment} frag the cloned template
       */
      EmployeeFormGenerator.prototype.updateBaselineWageElementId = function (frag) {
        var baselineWageElement = $(frag).find(
          "#" + this.baselineId + "1"
        );
        $(baselineWageElement).attr("id", $(baselineWageElement).attr("id").replace(this.employeeIndexRegex, "-" + this.numberOfEmployees));
        $(baselineWageElement).val("");
      }

      /**
       * updateInputs
       * 
       * update the id, class, and value for the new inputs. also update the 
       * label 'for' value with the new input id
       * 
       * @param {DOMDocumentFragment} frag the cloned template
       */
      EmployeeFormGenerator.prototype.updateInputs = function (frag) {
        var inputs = $(frag).find("input[id$='-1']");
        var numEmps = this.numberOfEmployees;
        var weeklyBaseClass = this.weeklySummaryBaseClass;
        var weeklyClass = this.weeklySummaryClass;
        var indexRegex = this.employeeIndexRegex;
        $(inputs).each(function (i, element) {
          if ($(element).is(":checkbox")) {
            $(element).prop("checked", false);
          } else if ($(element).attr("type", "text")) {
            $(element).val("");
          }
          //need to get the label for each of these elements and update the 'for' attr
          var label = $(frag).find("label[for='" + $(element).attr("id") + "']");
          $(element).attr(
            "id",
            $(element).attr("id").replace(indexRegex, "-" + numEmps)
          );
          $(label).attr(
            "for",
            $(label).attr("for").replace(indexRegex, "-" + numEmps)
          );
          //update the class that drives employee wage summary 
          if ($(element).hasClass(weeklyBaseClass)) {
            $(element).removeClass(weeklyBaseClass);
            $(element).addClass(weeklyClass + numEmps);
          }
        });
      }

      /**
       * setUpdatesAndUpdatedByData
       * 
       * increment the date-updates and data-updated-by value so the 
       * appropriate summary table is updated
       * 
       * @param {DOMDocumentFragment} frag the cloned template
       */
      EmployeeFormGenerator.prototype.setUpdatesAndUpdatedByData = function (frag) {
        var updateElements = $(frag).find("*[data-updates$='-1']");
        var updatedByElements = $(frag).find("*[data-updated-by$='-1']");
        var numEmps = this.numberOfEmployees;
        var indexRegex = this.employeeIndexRegex;
        $(updateElements).each(function (i, element) {
          var newval = $(element).data("updates").replace(indexRegex, "-" + numEmps);
          $(element).attr("data-updates", newval);
        });
        $(updatedByElements).each(function (i, element) {
          var newval = $(element).data("updated-by").replace(indexRegex, "-" + numEmps)
          $(element).attr("data-updated-by", newval);
        });
      }

      /**
       * updateTableIds
       * 
       * update table cell id and values required for employee wage summary
       * 
       * @param {DOMDocumentFragment} frag the cloned template
       */
      EmployeeFormGenerator.prototype.updateTableIds = function (frag) {
        var tds = $(frag).find("td[id$='-amt-1']");
        var totalCell = $(frag).find("td[id$='ttl-1']");
        var numEmps = this.numberOfEmployees;
        var currencyPlaceholderValue = this.currencyPlaceholderValue;
        var indexRegex = this.employeeIndexRegex;
        $(tds).each(function (i, element) {
          $(element).attr(
            "id",
            $(element).attr("id").replace(indexRegex, "-" + numEmps)
          );
          $(element).text(currencyPlaceholderValue);
        });
        $(totalCell).attr(
          "id",
          $(totalCell).attr("id").replace(indexRegex, "-" + numEmps)
        );
        $(totalCell).text(currencyPlaceholderValue);
        $(frag).find("#emp-no-elgbl-1").attr("id", "emp-no-elgbl-" + this.numberOfEmployees);
        $(frag).find("#emp-smry-1").attr("id", "emp-smry-" + this.numberOfEmployees);
      }

      /**
       * openAccordion
       *
       * open all open accordions
       *
       * @param {DOMDocumentFragment} frag the cloned template
       */
      EmployeeFormGenerator.prototype.openAccordion = function (frag) {
        var accordion = $(frag).find("details").each(function (i, element) {
          $(element).attr("open", "open");
        });
      }

      EmployeeFormGenerator.prototype.updateSummaryHeading = function (frag) {
        var heading = $(frag).find('.ee-name-1');
        $(heading).removeClass("ee-name-1");
        $(heading).addClass("ee-name-" + this.numberOfEmployees);
        $(heading).text("Employee " + this.numberOfEmployees);
      }

      return EmployeeFormGenerator;
    })();

  </script>
  <script>
    (function ($, window, wb) {
      "use strict";
      /*
      * Variable and function definitions.
      * These are global to the plugin - meaning that they will be initialized once per page,
      * not once per instance of plugin on the page. So, this is a good place to define
      * variables that are common to all instances of the plugin on a page.
      */
      // function that should be moved as a helper class or something
      const toMoney = new Intl.NumberFormat(wb.lang + "-CA", {
        style: "currency",
        currency: "CAD",
        minimumFractionDigits: 2
      });
      var employeeFormGenerator = new EmployeeFormGenerator();
      var componentName = "wb-calc",
        selector = "." + componentName,
        initEvent = "wb-init" + selector,
        $document = wb.doc,
        defaults = {},
        sep = {
          iso: {
            en: "--",
            fr: "--"
          },
          claim: {
            en: " to ",
            fr: " au "
          }
        },
        /**
         * @method init
         * @param {jQuery Event} event Event that triggered the function call
         */
        init = function (event) {
          // Start initialization
          // returns DOM object = proceed with init
          // returns undefined = do not proceed with init (e.g., already initialized)

          var elm = wb.init(event, componentName, selector),
            $elm,
            settings;

          if (elm) {
            $elm = $(elm);
            // ... Do the plugin initialisation
            // Get the plugin JSON configuration set on attribute data-wb-helloworld
            settings = $.extend(
              true,
              {},
              defaults,
              window[componentName],
              wb.getData($elm, componentName)
            );

            // Call my custom event
            $elm.trigger("change", settings);
            // Identify that initialization has completed
            wb.ready($elm, componentName);
          }
        };

      // Plugin event handlers
      $document.on("change", "input", function (event) {
        var elm = event.currentTarget,
          $elm = $(elm),
          $elmId = $elm.attr("id"),
          data = wb.getData($("output[for='" + $elmId + "']"), componentName),
          value = $elm.val().replace(/\,\s/g, ''), // Needs to be replaced by data.expr evaluation
          total = 0;

        if (data.expr) {
          //protect against NaN values
          if (value == "") {
            value = 0;
          }
          if (data.format === "currency") {
            $("output[for='" + $elmId + "']").html(toMoney.format(value * 1));
          } else {
            $("output[for='" + $elmId + "']").html(value * 1);
          };
        }

        total = ($("#p2c-cews").val() * 1) + ($("#p3-ei").val() * 1) + ($("#p3-cpp").val() * 1) - ($("#p4-tws").val() * 1) - ($("#p4-wsb").val() * 1);
        if (total < 0) {
          $("[for='p2c-cews p3-ei p3-cpp p4-tws p4-wsb']").html(toMoney.format(0));
        } else {
          $("[for='p2c-cews p3-ei p3-cpp p4-tws p4-wsb']").html(toMoney.format(total));
        };
      });

      $document.on("change", selector, function (event, data) {
        var elm = event.currentTarget,
          $elm = $(elm),
          $input = $("#" + $elm.attr("for")),
          value = $input.val();

        if (data && data.format === "currency") {
          $elm.html(toMoney.format(value * 1));
        } else {
          $elm.html(value * 1);
        };
        $("[for='p2c-ee p2c-pyrl p2c-cews p3-ei p3-cpp p4-tws p4-wsb']").html(toMoney.format(0));
      });

      //when the claim period dropdown is changed
      $document.on("change", "#claim-period", function (event) {
        var rangeISO = $(this).find('option:selected').val(),
          startDateISO = rangeISO.substring(0, rangeISO.indexOf(sep.iso[wb.lang])),
          endDateISO = rangeISO.substring(rangeISO.indexOf(sep.iso[wb.lang]) + sep.iso[wb.lang].length, rangeISO.length),
          rangeClaim = $(this).find("option:selected").text(),
          rangeClaimNo = rangeClaim.substring(7, 8),
          startDateClaim = rangeClaim.substring(0, rangeClaim.indexOf(sep.claim[wb.lang])),
          endDateClaim = rangeClaim.substring(rangeClaim.indexOf(sep.claim[wb.lang]) + sep.claim[wb.lang].length, rangeClaim.length);

        var claimPeriod = parseInt($("#claim-period option:selected").data("claim-period"));
        if (!$("#claim-period option:selected:eq(0)")) {
          $('.claim-period').html("<time datetime=\"" + startDateISO + "\">" + startDateClaim + "</time>" + sep.claim[wb.lang] + "<time datetime=\"" + endDateISO + "\">" + endDateClaim + "</time>");
        } else {
          $('.claim-period').html($("#claim-period option:selected").text());
          $(".claim-period-no").text(claimPeriod);
        }
        //show/hide elements based on chosen claim period



        switch (claimPeriod) {
          case 9:
            $("#rate-reduction").removeClass("hidden");
            $(".emp-lv").removeClass("hidden");
            $("#p4-tws").prop("readonly", true);
            $("#p4-tws").val("0.00");
            $("#p4-tws-disclaimer").removeClass("hidden");
            $("#cal-sprdsht-p1-4").addClass("hidden");
            $("#cal-sprdsht-none").addClass("hidden");
            $("#cal-sprsht-p5").addClass("hidden");
            $("#cal-sprsht-p7").removeClass("hidden");
            $(".p59").removeClass("hidden");
            $(".p14").addClass("hidden");
            $(".btn-cews-cal").removeClass("disabled");
            $(".btn-cews-cal").prop("disabled", false);
            $(".choose-claim-period").addClass("hidden");
            $("#2020-11-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-10-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-09-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-08-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-07-yes").closest("div.form-group").addClass("hidden");
            $("#2020-06-yes").closest("div.form-group").addClass("hidden");
            $("#2020-05-yes").closest("div.form-group").addClass("hidden");
            $("#2020-04-yes").closest("div.form-group").addClass("hidden");
            $("#2020-11-no").closest("div.form-group").removeClass("hidden");
            $("#2019-11-no").closest("div.form-group").removeClass("hidden");
            $("#2020-10-no").closest("div.form-group").removeClass("hidden");
            $("#2019-10-no").closest("div.form-group").removeClass("hidden");
            $("#2020-09-no").closest("div.form-group").removeClass("hidden");
            $("#2019-09-no").closest("div.form-group").removeClass("hidden");
            $("#2020-08-no").closest("div.form-group").removeClass("hidden");
            $("#2019-08-no").closest("div.form-group").removeClass("hidden");
            $("#2020-07-no").closest("div.form-group").addClass("hidden");
            $("#2019-07-no").closest("div.form-group").addClass("hidden");
            $("#2020-06-no").closest("div.form-group").addClass("hidden");
            $("#2019-06-no").closest("div.form-group").addClass("hidden");
            $("#2020-05-no").closest("div.form-group").addClass("hidden");
            $("#2019-05-no").closest("div.form-group").addClass("hidden");
            $("#2020-04-no").closest("div.form-group").addClass("hidden");
            $("#2019-04-no").closest("div.form-group").addClass("hidden");
            break;
          case 8:
            $("#rate-reduction").removeClass("hidden");
            $(".emp-lv").removeClass("hidden");
            $("#p4-tws").prop("readonly", true);
            $("#p4-tws").val("0.00");
            $("#p4-tws-disclaimer").removeClass("hidden");
            $("#cal-sprdsht-p1-4").addClass("hidden");
            $("#cal-sprdsht-none").addClass("hidden");
            $("#cal-sprsht-p5").addClass("hidden");
            $("#cal-sprsht-p7").removeClass("hidden");
            $(".p59").removeClass("hidden");
            $(".p14").addClass("hidden");
            $(".btn-cews-cal").removeClass("disabled");
            $(".btn-cews-cal").prop("disabled", false);
            $(".choose-claim-period").addClass("hidden");
            $("#2020-11-yes").closest("div.form-group").addClass("hidden");
            $("#2020-10-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-09-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-08-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-07-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-06-yes").closest("div.form-group").addClass("hidden");
            $("#2020-05-yes").closest("div.form-group").addClass("hidden");
            $("#2020-04-yes").closest("div.form-group").addClass("hidden");
            $("#2020-11-no").closest("div.form-group").addClass("hidden");
            $("#2019-11-no").closest("div.form-group").addClass("hidden");
            $("#2020-10-no").closest("div.form-group").removeClass("hidden");
            $("#2019-10-no").closest("div.form-group").removeClass("hidden");
            $("#2020-09-no").closest("div.form-group").removeClass("hidden");
            $("#2019-09-no").closest("div.form-group").removeClass("hidden");
            $("#2020-08-no").closest("div.form-group").removeClass("hidden");
            $("#2019-08-no").closest("div.form-group").removeClass("hidden");
            $("#2020-07-no").closest("div.form-group").removeClass("hidden");
            $("#2019-07-no").closest("div.form-group").removeClass("hidden");
            $("#2020-06-no").closest("div.form-group").addClass("hidden");
            $("#2019-06-no").closest("div.form-group").addClass("hidden");
            $("#2020-05-no").closest("div.form-group").addClass("hidden");
            $("#2019-05-no").closest("div.form-group").addClass("hidden");
            $("#2020-04-no").closest("div.form-group").addClass("hidden");
            $("#2019-04-no").closest("div.form-group").addClass("hidden");
            break;
          case 7:
            $("#rate-reduction").removeClass("hidden");
            $(".emp-lv").removeClass("hidden");
            $("#p4-tws").prop("readonly", true);
            $("#p4-tws").val("0.00");
            $("#p4-tws-disclaimer").removeClass("hidden");
            $("#cal-sprdsht-p1-4").addClass("hidden");
            $("#cal-sprdsht-none").addClass("hidden");
            $("#cal-sprsht-p5").addClass("hidden");
            $("#cal-sprsht-p7").removeClass("hidden");
            $(".p59").removeClass("hidden");
            $(".p14").addClass("hidden");
            $(".btn-cews-cal").removeClass("disabled");
            $(".btn-cews-cal").prop("disabled", false);
            $(".choose-claim-period").addClass("hidden");
            $("#2020-11-yes").closest("div.form-group").addClass("hidden");
            $("#2020-10-yes").closest("div.form-group").addClass("hidden");
            $("#2020-09-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-08-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-07-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-06-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-05-yes").closest("div.form-group").addClass("hidden");
            $("#2020-04-yes").closest("div.form-group").addClass("hidden");
            $("#2020-11-no").closest("div.form-group").addClass("hidden");
            $("#2019-11-no").closest("div.form-group").addClass("hidden");
            $("#2020-10-no").closest("div.form-group").addClass("hidden");
            $("#2019-10-no").closest("div.form-group").addClass("hidden");
            $("#2020-09-no").closest("div.form-group").removeClass("hidden");
            $("#2019-09-no").closest("div.form-group").removeClass("hidden");
            $("#2020-08-no").closest("div.form-group").removeClass("hidden");
            $("#2019-08-no").closest("div.form-group").removeClass("hidden");
            $("#2020-07-no").closest("div.form-group").removeClass("hidden");
            $("#2019-07-no").closest("div.form-group").removeClass("hidden");
            $("#2020-06-no").closest("div.form-group").removeClass("hidden");
            $("#2019-06-no").closest("div.form-group").removeClass("hidden");
            $("#2020-05-no").closest("div.form-group").addClass("hidden");
            $("#2019-05-no").closest("div.form-group").addClass("hidden");
            $("#2020-04-no").closest("div.form-group").addClass("hidden");
            $("#2019-04-no").closest("div.form-group").addClass("hidden");
            break;
          case 6:
            $("#rate-reduction").removeClass("hidden");
            $(".emp-lv").removeClass("hidden");
            $("#p4-tws").prop("readonly", true);
            $("#p4-tws").val("0.00");
            $("#p4-tws-disclaimer").removeClass("hidden");
            $("#cal-sprdsht-p1-4").addClass("hidden");
            $("#cal-sprdsht-none").addClass("hidden");
            $("#cal-sprsht-p5").removeClass("hidden");
            $("#cal-sprsht-p7").addClass("hidden");
            $(".p59").removeClass("hidden");
            $(".p14").addClass("hidden");
            $(".btn-cews-cal").removeClass("disabled");
            $(".btn-cews-cal").prop("disabled", false);
            $(".choose-claim-period").addClass("hidden");
            $("#2020-11-yes").closest("div.form-group").addClass("hidden");
            $("#2020-10-yes").closest("div.form-group").addClass("hidden");
            $("#2020-09-yes").closest("div.form-group").addClass("hidden");
            $("#2020-08-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-07-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-06-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-05-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-04-yes").closest("div.form-group").addClass("hidden");
            $("#2020-11-no").closest("div.form-group").addClass("hidden");
            $("#2019-11-no").closest("div.form-group").addClass("hidden");
            $("#2020-10-no").closest("div.form-group").addClass("hidden");
            $("#2019-10-no").closest("div.form-group").addClass("hidden");
            $("#2020-09-no").closest("div.form-group").addClass("hidden");
            $("#2019-09-no").closest("div.form-group").addClass("hidden");
            $("#2020-08-no").closest("div.form-group").removeClass("hidden");
            $("#2019-08-no").closest("div.form-group").removeClass("hidden");
            $("#2020-07-no").closest("div.form-group").removeClass("hidden");
            $("#2019-07-no").closest("div.form-group").removeClass("hidden");
            $("#2020-06-no").closest("div.form-group").removeClass("hidden");
            $("#2019-06-no").closest("div.form-group").removeClass("hidden");
            $("#2020-05-no").closest("div.form-group").removeClass("hidden");
            $("#2019-05-no").closest("div.form-group").removeClass("hidden");
            $("#2020-04-no").closest("div.form-group").addClass("hidden");
            $("#2019-04-no").closest("div.form-group").addClass("hidden");
            break;
          case 5:
            $("#rate-reduction").removeClass("hidden");
            $(".emp-lv").removeClass("hidden");
            $("#p4-tws").prop("readonly", true);
            $("#p4-tws").val("0.00");
            $("#p4-tws-disclaimer").removeClass("hidden");
            $("#cal-sprdsht-p1-4").addClass("hidden");
            $("#cal-sprdsht-none").addClass("hidden");
            $("#cal-sprsht-p5").removeClass("hidden");
            $("#cal-sprsht-p7").addClass("hidden");
            $(".p59").removeClass("hidden");
            $(".p14").addClass("hidden");
            $(".btn-cews-cal").removeClass("disabled");
            $(".btn-cews-cal").prop("disabled", false);
            $(".choose-claim-period").addClass("hidden");
            $("#2020-11-yes").closest("div.form-group").addClass("hidden");
            $("#2020-10-yes").closest("div.form-group").addClass("hidden");
            $("#2020-09-yes").closest("div.form-group").addClass("hidden");
            $("#2020-08-yes").closest("div.form-group").addClass("hidden");
            $("#2020-07-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-06-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-05-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-04-yes").closest("div.form-group").removeClass("hidden");
            $("#2020-11-no").closest("div.form-group").addClass("hidden");
            $("#2019-11-no").closest("div.form-group").addClass("hidden");
            $("#2020-10-no").closest("div.form-group").addClass("hidden");
            $("#2019-10-no").closest("div.form-group").addClass("hidden");
            $("#2020-09-no").closest("div.form-group").addClass("hidden");
            $("#2019-09-no").closest("div.form-group").addClass("hidden");
            $("#2020-08-no").closest("div.form-group").addClass("hidden");
            $("#2019-08-no").closest("div.form-group").addClass("hidden");
            $("#2020-07-no").closest("div.form-group").removeClass("hidden");
            $("#2019-07-no").closest("div.form-group").removeClass("hidden");
            $("#2020-06-no").closest("div.form-group").removeClass("hidden");
            $("#2019-06-no").closest("div.form-group").removeClass("hidden");
            $("#2020-05-no").closest("div.form-group").removeClass("hidden");
            $("#2019-05-no").closest("div.form-group").removeClass("hidden");
            $("#2020-04-no").closest("div.form-group").removeClass("hidden");
            $("#2019-04-no").closest("div.form-group").removeClass("hidden");
            break
          case 4:
          case 3:
          case 2:
          case 1:
            $("#cal-sprdsht-p1-4").removeClass("hidden");
            $("#cal-sprsht-p5").addClass("hidden");
            $("#cal-sprsht-p7").addClass("hidden");
            $("#rate-reduction").addClass("hidden");
            $(".emp-lv").addClass("hidden");
            $("#p4-tws").prop("readonly", false);
            $("#p4-tws-disclaimer").addClass("hidden");
            $(".p14").removeClass("hidden");
            $(".p59").addClass("hidden");
            $("#cal-sprdsht-none").addClass("hidden");
            $(".btn-cews-cal").removeClass("disabled");
            $(".btn-cews-cal").prop("disabled", false);
            $(".choose-claim-period").addClass("hidden");
            break;
          default:
            $("#rate-reduction").addClass("hidden");
            $(".emp-lv").addClass("hidden");
            $("#p4-tws").prop("readonly", false);
            $("#p4-tws-disclaimer").addClass("hidden");
            $(".p59").addClass("hidden");
            $(".p14").removeClass("hidden");
            $(".btn-cews-cal").addClass("disabled");
            $(".btn-cews-cal").prop("disabled", true);
            $(".choose-claim-period").removeClass("hidden");
        }
      });

      // when the submit button is clicked
      $document.on("click", "#calculate", function (event) {
        event.preventDefault();
        //remove the required attribute in all hidden elements
        $("[required]:hidden").each(function (i, element) {
          $(element).removeAttr("required");
        });
        var count = 0,
          $elms = $(".wb-frmvld select[required], .wb-frmvld input[required]"),
          $emptyElms = [];
        //find all required fields that were left empty
        for (let i = 0; i < $($elms).length; i++) {
          var $elm = $($elms).eq(i);
          if ($elm.val() == "") {
            $emptyElms.push($elm);
            count++;
          }
        }
        //if WET4 already has errors, scroll to those
        if ($("#errors-default")[0]) {
          $('html, body').animate({ scrollTop: $("#errors-default").offset().top }, 'slow');
          //scroll to the FIRST element that failed custom validation
        } else if ($emptyElms[0]) {
          $('html, body').animate({ scrollTop: $($emptyElms[0]).offset().top }, 'slow');
          console.debug($emptyElms);
          //validation passed, show the results
        } else {
          $("#results").removeClass("hidden");
        }
      });

      /**
       * update the employee wage summary
       */
      var numEmployeePanels = 1;
      $document.on("blur", "*[data-updates]", function (event) {
        var target = event.target;
        var parts = target.id.split("-");
        var employeeNumber = parts[parts.length - 1];
        var unformattedValue = target.value.replace("$", "");
        var claimPeriod = $("#claim-period option:selected").data("claim-period");
        if (claimPeriod < 5) {
          if (!checkEmployeeEligibility(target)) {
            $("#emp-smry-" + employeeNumber).addClass("hidden");
            $("#emp-no-elgbl-" + employeeNumber).removeClass("hidden");
            var updatedByElements = $("*[data-updated-by='" + target.id + "']");
            $(updatedByElements).each(function (i, element) {
              $(element).text(toMoney.format(0.00));
            });
          } else {
            $("#emp-no-elgbl-" + employeeNumber).addClass("hidden");
            $("#emp-smry-" + employeeNumber).removeClass("hidden");
          }
        }

        var updateTarget = $("#" + $(target).attr("data-updates"));
        //if the target is a select element, capitalize the first letter then update the target
        if (target.nodeName == 'SELECT') {
          var formattedVal = target.value.charAt(0).toUpperCase() + target.value.slice(1);
          $(updateTarget).text(formattedVal);
        } else if ($(target).is(":checkbox")) {
          return;
          //target was an input type=text
        } else {
          var baselineWage = parseFloat($("#baseline-" + employeeNumber).val());
          var armsLength = $("#arms-" + employeeNumber).val().toLowerCase() == "yes" || $("#arms-" + employeeNumber).val().toLowerCase() == "oui" ? true : false;
          //get the wkX prefix of the input being updated, look for the leave w/ pay input with the same prefix
          var parts = target.id.match(/(wk)(one|two|three|four)-/g);
          if (!parts) {
            return;
          }
          var weekNumber = parts[0];
          var paidLeave = $("#" + weekNumber + "cb-" + employeeNumber).is(":checked");
          //get the weekly cews; if it's not an int or float, use 0
          var weeklyCews = getWeeklyCEWS(armsLength, baselineWage, parseFloat(unformattedValue), paidLeave);
          if (!isInt(weeklyCews) && !isFloat(weeklyCews)) {
            weeklyCews = 0;
          }
          //format and update the targets using localized currency format
          var formattedVal = toMoney.format(weeklyCews);
          $(updateTarget).text(formattedVal);
          var updatedByElements = $("*[data-updated-by='" + target.id + "']");
          $(updatedByElements).each(function (i, element) {
            $(element).text(toMoney.format(unformattedValue));
          });
          //update the total
          if ($(updateTarget).data("updates")) {
            /*
              update the target to the total column and get all elements that make up the total
            */
            updateTarget = $("#" + $(updateTarget).attr("data-updates"));
            //get the total cews
            var employeeCews = getEmployeeCews(employeeNumber, baselineWage);
            var formattedTotal = toMoney.format(employeeCews);
            $(updateTarget).text(formattedTotal);
          }
        }
      });

      //when the user clicks the remove button on an employee panel
      $(document).on("click", ".rm-emp", function(event) {
        var fieldset = $(event.target).parent("fieldset");
        var id = $(fieldset).attr("id");
        var empNumber = id.split("-")[1];
        $("#emp-arms-" + empNumber).parent("tr").remove();
        $(fieldset).remove();
      });

      //https://stackoverflow.com/questions/3885817/how-do-i-check-that-a-number-is-float-or-integer
      function isInt(n) {
        return Number(n) === n && n % 1 === 0;
      }
      function isFloat(n) {
        return Number(n) === n && n % 1 !== 0;
      }

      /**
       * getEmployeeCews()
       * 
       * get the cews total for an employee 
       * 
       * @param {Int} employeeNumber The employee panel number
       * @param {String} baselineWage The employees baseline pre-crisis wage
       *
       * @return {Float} Total calculated cews for this employee || 0 if not 
       * all data was entered
       */
      function getEmployeeCews(employeeNumber, baselineWage) {
        var armsLength = $("#arms-" + employeeNumber).val() == "Yes" || $("#arms-" + employeeNumber).val() == "Oui" ? true : false;
        var weekone = zeroIfEmpty($('#wkone-' + employeeNumber).val());
        var weekOnePaidLeave = $("#wkone-cb-" + employeeNumber).is(":checked");
        var weektwo = zeroIfEmpty($('#wktwo-' + employeeNumber).val());
        var weekTwoPaidLeave = $("#wktwo-cb-" + employeeNumber).is(":checked");
        var weekthree = zeroIfEmpty($('#wkthree-' + employeeNumber).val());
        var weekThreePaidLeave = $("#wkthree-cb-" + employeeNumber).is(":checked");
        var weekfour = zeroIfEmpty($('#wkfour-' + employeeNumber).val());
        var weekFourPaidLeave = $("#wkfour-cb-" + employeeNumber).is(":checked");
        var weekOneCews = getWeeklyCEWS(armsLength, baselineWage, weekone, weekOnePaidLeave);
        var weekTwoCews = getWeeklyCEWS(armsLength, baselineWage, weektwo, weekTwoPaidLeave);
        var weekThreeCews = getWeeklyCEWS(armsLength, baselineWage, weekthree, weekThreePaidLeave);
        var weekFourCews = getWeeklyCEWS(armsLength, baselineWage, weekfour, weekFourPaidLeave);
        if (
          isNaN(weekOneCews) ||
          isNaN(weekTwoCews) ||
          isNaN(weekThreeCews) ||
          isNaN(weekFourCews)
        ) {
          return 0;
        }
        return parseFloat(weekOneCews + weekTwoCews + weekThreeCews + weekFourCews);
      }

      /**
       * getEmployeeTotalWages
       * 
       * get the total wages paid for the given employee number
       *
       * @param {Int} employeeNumber The employee panel number 
       * 
       * @return {Float} The total wage paid for 4 weeks 
       */
      function getEmployeeTotalWages(employeeNumber) {
        var weekone = zeroIfEmpty($('#wkone-' + employeeNumber).val());
        var weektwo = zeroIfEmpty($('#wktwo-' + employeeNumber).val());
        var weekthree = zeroIfEmpty($('#wkthree-' + employeeNumber).val());
        var weekthree = zeroIfEmpty($('#wkthree-' + employeeNumber).val());
        var weekfour = zeroIfEmpty($('#wkfour-' + employeeNumber).val());
        return parseFloat(weekone) + parseFloat(weektwo) + parseFloat(weekthree) + parseFloat(weekfour);
      }

      /**
       * calculate the total wages/total cews when the summary table is opened
       */
      $(document).on("click", "#showEmpTable", function (event) {
        calculateTotals();
      });
      function calculateTotals() {
        var totalWagesPaid = 0;
        var cews = 0;
        var eligibleEmployees = 0;
        $("#dataset-filter > tbody > tr").each(function (i, element) {
          var id = $(element).prop("id").split("emp")[1];
          var eligibility = true;
          //determine the eligibility
          if ($("#emp-smry-" + id).hasClass("hidden")) {
            eligibility = false;
          }
          //show baselineWage or 0 if the baseline was left empty (protect against showing NaN)
          var baselineWage = $("#baseline-" + id).val();
          if (baselineWage == "") {
            $("#emp-base-" + id).text(toMoney.format("0.00"));
          } else {
            baselineWage = parseFloat(baselineWage);
          }
          $("#emp-base-" + id).text(toMoney.format(baselineWage));
          //show the arms length value
          $("#emp-arms-" + id).text($("#arms-" + id).val());
          var totalCell = $("#emp-ttl-" + id);
          if (eligibility) {
            eligibleEmployees++;
            var employeeCews = zeroIfEmpty(getEmployeeCews(id, baselineWage));
            cews += employeeCews;
            totalWagesPaid += zeroIfEmpty(getEmployeeTotalWages(id));
            var formattedTotal = toMoney.format(Math.max(employeeCews, 0));
            $("#emp-ttl-" + id).text(employeeCews);
            $(totalCell).html(formattedTotal);
          } else {
            $(totalCell).html(toMoney.format(0.00));
          }
        });
        $(".numEmps").text(eligibleEmployees);
        $(".total").html(toMoney.format(cews));
        $(".total").attr("data-total-cews", cews.toFixed(2));
        $(".total").attr("data-total-wages", totalWagesPaid.toFixed(2));
      }

      /**
       * getWeeklyCEWS
       * 
       * determine the weekly cews amount based on claim period
       *
       * @param {Boolean} armsLength Whether the employee is at arms length
       * @param {String} baselineAmount The employees baseline pay pre-crisis
       * @param {String} weeklyAmount The weekly wage value
       * @param {Boolean} paidLeave Whether the employee was on paid leave for 
       * the week being calculated
       * 
       * @return {Int} The calculated weekly cews amount || 0 if no claim 
       * period is chosen
       */
      function getWeeklyCEWS(armsLength, baselineAmount, weeklyAmount, paidLeave) {
        var period = parseInt($("#claim-period option:selected").data("claim-period"));
        switch (true) {
          //period 1-4
          case (period < 5):
            return oldFormula(armsLength, weeklyAmount, baselineAmount)
            break;
          // period 5-7
          case (period < 7):
            if (paidLeave) {
              return oldFormula(armsLength, weeklyAmount, baselineAmount);
            } else {
              if (cewsRate == 0) {
                return 0;
              } else if (revReduction >= 0.3) {
                return Math.max(oldFormula(armsLength, weeklyAmount, baselineAmount), newFormula(armsLength, weeklyAmount, baselineAmount, cewsRate));
              } else {
                return Math.max(newFormula(armsLength, weeklyAmount, baselineAmount, cewsRate), 0);
              }
            }
            break;
          //period 7+
          case (period > 6):
            if (paidLeave) {
              return oldFormula(armsLength, weeklyAmount, baselineAmount);
            } else {
              if (cewsRate == 0) {
                return 0;
              } else {
                return Math.max(newFormula(armsLength, weeklyAmount, baselineAmount, cewsRate), 0);
              }
            }
            break;
          default:
            return 0;
        }
      }

      /**
       * determine if an employee has been paid $0 for two consecutive pays
       */
      function checkEmployeeEligibility(element) {
        //get all inputs for this employees weekly wages
        var classname = element.className.match(/emp-wkly-wage-\d/g);
        if (classname == "") {
          return;
        }
        var eligibility = true;
        var wages = $("." + classname);
        $(wages).each(function (i, element) {
          if (parseFloat($(element).val()) == 0 && $(wages[i + 1]).val() == 0 && $(wages[i + 1]).val() != "") {
            eligibility = false;
          }
        });
        return eligibility;
      }


      /**
       * add a new employee form  
       */
      $("#addemp").on("click", addEmp);
      $("#addemp").on("keypress", addEmp);
      function addEmp() {
        numEmployeePanels++;
        var frag = employeeFormGenerator.generateNewEmployeeForm(
          numEmployeePanels
        );
        //create new row for the calculation table
        var row = document.createElement("tr");
        row.id = "emp" + numEmployeePanels;
        //create the employee 'name' cell
        var eligibleEmployeeCell = document.createElement("td");
        var eeSpan = document.createElement("span");
        $(eeSpan).addClass("ee-name-" + numEmployeePanels);
        eeSpan.innerHTML = "Employee " + numEmployeePanels;
        eligibleEmployeeCell.appendChild(eeSpan);
        // create the arms length cell 
        var armsLengthCell = document.createElement("td");
        armsLengthCell.id = "emp-arms-" + numEmployeePanels;
        //create the cell for the baseline wage
        var baselineCell = document.createElement("td");
        baselineCell.id = "emp-base-" + numEmployeePanels;
        //create cells for each wage entry
        var weeklyWageCells = [];
        for (var i = 0; i < 4; i++) {
          weeklyWageCells[i] = document.createElement("td");
        }
        //add the data-update-by attr so these cells are populated by the blur event on *[data-updates]
        $(weeklyWageCells[0]).attr(
          "data-updated-by",
          "wkone-" + numEmployeePanels
        );
        $(weeklyWageCells[1]).attr(
          "data-updated-by",
          "wktwo-" + numEmployeePanels
        );
        $(weeklyWageCells[2]).attr(
          "data-updated-by",
          "wkthree-" + numEmployeePanels
        );
        $(weeklyWageCells[3]).attr(
          "data-updated-by",
          "wkfour-" + numEmployeePanels
        );
        //create the total cell
        var totalCell = document.createElement("td");
        totalCell.id = "emp-ttl-" + numEmployeePanels;
        //put the row together
        row.appendChild(eligibleEmployeeCell);
        row.appendChild(armsLengthCell);
        row.appendChild(baselineCell);
        $(weeklyWageCells).each(function (i, element) {
          row.appendChild(weeklyWageCells[i]);
        });
        //add the row to the table
        row.appendChild(totalCell);
        $("#dataset-filter > tbody").append(row);
        var lastEmpPanel = $("fieldset[id^='emp-']").last();
        $(frag).insertAfter(lastEmpPanel);
        $("#emp-" + numEmployeePanels).focus();
        document.getElementById($(frag).prop("id")).scrollIntoView({
          behavior: 'smooth'
        });
        $("#emp-no-elgbl-" + numEmployeePanels).addClass("hidden");
        $("#emp-smry-" + numEmployeePanels).removeClass("hidden");
      }

      /**
       * calculate the cews rate reductions
       */
      var currentRevReduc = 0;
      var priorRevReduc = 0;
      var revReduction = 0;
      var claimPeriodRevReduction = 0;
      var topUpRate = 0;
      var cewsRate = 0;
      var baseRate = 0;
      var claimMonthPrefix = "";
      var prevMonthPrefix = "";
      var prev2MonthPrefix = "";
      var prev3MonthPrefix = "";
      var threeMonthReduction = 0;
      $document.on("blur", ".cews-rate-calc", function (event) {
        var claimPeriod = parseInt($("#claim-period option:selected").data("claim-period"));
        if (claimPeriod < 8) {
          claimMonthPrefix = "0";
        }
        if (claimPeriod < 9) {
          prevMonthPrefix = "0";
        }
        if (claimPeriod < 10) {
          prev2MonthPrefix = "0";
        }
        if (claimPeriod < 11) {
          prev3MonthPrefix = "0";
        }
        var cewsRateElements = $('.cews-rate-calc');
        var month = getClaimMonth($("#claim-period").val());
        //find the claim month based on the chosen claim period
        var claimMonth = new Date(
          "2020-" + claimMonthPrefix + month + '-01'
        ).getUTCMonth();
        //get the previous month from the claim month
        var prevClaimMonth = claimMonth - 1;
        if (
          (
            parseFloat(zeroIfEmpty($("#2019-" + claimMonthPrefix + claimMonth + "-no").val())) > 0 ||
            parseFloat(zeroIfEmpty($("#2019-" + prevMonthPrefix + prevClaimMonth + "-no").val())) > 0
          ) &&
          (
            parseFloat(zeroIfEmpty($("#2019-" + prev3MonthPrefix + (claimMonth - 3) + "-no").val())) > 0 ||
            parseFloat(zeroIfEmpty($("#2019-" + prev2MonthPrefix + (claimMonth - 2) + "-no").val())) > 0 ||
            parseFloat(zeroIfEmpty($("#2019-" + prevMonthPrefix + (claimMonth - 1) + "-no").val())) > 0
          )
        ) {
          //get the value of the claim month
          var claimMonth2020Value = zeroIfEmpty($("#2020-" + claimMonthPrefix + claimMonth + "-no").val());
          var claimMonth2019Value = zeroIfEmpty($("#2019-" + claimMonthPrefix + claimMonth + "-no").val());
          //get the value of the previous month
          var prevClaim2020Value = zeroIfEmpty($("#2020-" + prevMonthPrefix + prevClaimMonth + "-no").val());
          var prevClaim2019Value = zeroIfEmpty($("#2019-" + prevMonthPrefix + prevClaimMonth + "-no").val());
          //get the avg of the revenue from the previous three motnhs (2020)
          var threeMonthRev2020 = [
            zeroIfEmpty($("#2020-" + prev3MonthPrefix + (claimMonth - 3) + "-no").val()),
            zeroIfEmpty($("#2020-" + prev2MonthPrefix + (claimMonth - 2) + "-no").val()),
            zeroIfEmpty($("#2020-" + prevMonthPrefix + prevClaimMonth + "-no").val())
          ];
          var threeMonthAvg2020 = (threeMonthRev2020[0] + threeMonthRev2020[1] + threeMonthRev2020[2]) / 3;
          //get the avg of the revenue from the previous three months (2019)
          var threeMonthRev2019 = [
            zeroIfEmpty($("#2019-" + prev3MonthPrefix + (claimMonth - 3) + "-no").val()),
            zeroIfEmpty($("#2019-" + prev2MonthPrefix + (claimMonth - 2) + "-no").val()),
            zeroIfEmpty($("#2019-" + prevMonthPrefix + prevClaimMonth + "-no").val())
          ];
          var threeMonthAvg2019 = (threeMonthRev2019[0] + threeMonthRev2019[1] + threeMonthRev2019[2]) / 3;
          //get the rate reduction from the three month average
          threeMonthReduction = (threeMonthAvg2019 - threeMonthAvg2020) / threeMonthAvg2019;
          //get the revenue reduction from claim/prev claim months from 2020 and 2019
          claimPeriodRevReduction = (claimMonth2019Value - claimMonth2020Value) / claimMonth2019Value;
          if (claimMonth2019Value == 0) {
            revReduction = (prevClaim2019Value - prevClaim2020Value) / prevClaim2019Value;
            priorRevReduc = (prevClaim2019Value - prevClaim2020Value) / prevClaim2019Value;
            currentRevReduc = 0;
          } else if (prevClaim2019Value == 0) {
            revReduction = (claimMonth2019Value - claimMonth2020Value) / claimMonth2019Value;
            priorRevReduc = 0;
            currentRevReduc = (claimMonth2019Value - claimMonth2020Value) / claimMonth2019Value;
          } else {
            revReduction = Math.max(
              (claimMonth2019Value - claimMonth2020Value) / claimMonth2019Value,
              (prevClaim2019Value - prevClaim2020Value) / prevClaim2019Value
            );
            priorRevReduc = (prevClaim2019Value - prevClaim2020Value) / prevClaim2019Value;
            currentRevReduc = (claimMonth2019Value - claimMonth2020Value) / claimMonth2019Value;
          }
          //get the base rate
          baseRate = parseFloat(Math.max(getP5PlusBaseRate(revReduction), 0));
          //get the top-up rate
          topUpRate = parseFloat(Math.max(getP5PlusTopUpRate(threeMonthReduction), 0));
          //calculate the overall rate
          cewsRate = (baseRate + topUpRate).toFixed(4);
          if (cewsRate < 0.1) {
            $("#employees").addClass("hidden");
          }
          if (cewsRate < 0.75 && revReduction >= 0.3 && claimPeriod < 7) {
            //if safe harbour applies
            cewsRate = 0.75;
            $("#rate-reduction").addClass("hidden");
            $(".safe-harbour-show").removeClass("hidden");
            $(".safe-harbour-hide").addClass("hidden");
          } else {
            //if safe harbour doesn't apply
            $(".safe-harbour-show").addClass("hidden");
            $(".safe-harbour-hide").removeClass("hidden");
            //update the view and round down base and top up dates to nearest 2 decimals on the percentage
            $(".top-up-rate").text(roundPercDown(topUpRate) + "%");
            $(".base-rate").text(roundPercDown(baseRate) + "%");
          }
          $("#currentRevReduction").text(roundPercDown(currentRevReduc) + "%");
          $("#priorRevReduction").text(roundPercDown(priorRevReduc) + "%");
          $(".rev-drop-top-up").text(roundPercDown(threeMonthReduction) + "%");
          $(".rev-reduc-base").text(roundPercDown(revReduction) + "%");
          $("#cews-rate").text(Math.floor(cewsRate * 10000) / 100 + "%");
          $("#employees").removeClass("hidden");
        } else {
          //if it can't compute because of 0 values, then reset calculation summary to 0
          $("#currentRevReduction").text("0%");
          $("#priorRevReduction").text("0%");
          $(".top-up-rate").text("0%");
          $(".base-rate").text("0%");
          $(".rev-drop-top-up").text("0%");
          $(".rev-reduc-base").text("0%");
          $("#cews-rate").text("0%");
        }
      });

      /**
       * calculate the cews rate reductions with alternate baseline
       */
      $document.on("blur", ".cews-rate-calc-alt", function (event) {
        var claimPeriod = parseInt($("#claim-period option:selected").data("claim-period"));
        var cewsRateElements = $('.cews-rate-calc-alt');
        var janRev = zeroIfEmpty($("#2020-01-yes").val());
        var febRev = zeroIfEmpty($("#2020-02-yes").val());
        if (parseFloat(janRev) > 0 || parseFloat(febRev) > 0) {
          var baseRev = (janRev + febRev) / 2;
          //find the claim month based on the chosen claim period 
          var claimMonth = new Date(
            "2020-" + getClaimMonth($("#claim-period").val()) + '-01'
          ).getUTCMonth();
          if (claimPeriod < 8) {
            claimMonthPrefix = "0";
          }
          if (claimPeriod < 9) {
            prevMonthPrefix = "0";
          }
          if (claimPeriod < 10) {
            prev2MonthPrefix = "0";
          }
          if (claimPeriod < 11) {
            prev3MonthPrefix = "0";
          }
          //get the value of the claim month
          var claimMonthValue = zeroIfEmpty($("#2020-" + claimMonthPrefix + claimMonth + "-yes").val());
          //get the previous month from the claim month
          var prevClaimMonth = claimMonth - 1;
          //get the value of the previous month
          var prevClaimValue = zeroIfEmpty($("#2020-" + prevMonthPrefix + prevClaimMonth + "-yes").val());
          //get the avg of the revenue from the last three months
          var threeMonthAvg = (zeroIfEmpty($("#2020-" + prev3MonthPrefix + (claimMonth - 3) + "-yes").val()) + zeroIfEmpty($("#2020-" + prev2MonthPrefix + (claimMonth - 2) + "-yes").val()) + zeroIfEmpty($("#2020-" + prevMonthPrefix + (claimMonth - 1) + "-yes").val())) / 3;
          //get the rate reduction from the three month average
          threeMonthReduction = (baseRev - threeMonthAvg) / baseRev;
          claimPeriodRevReduction = (baseRev - claimMonthValue) / baseRev;
          //get the revenue reduction
          revReduction = Math.max(
            (baseRev - claimMonthValue) / baseRev,
            (baseRev - prevClaimValue) / baseRev
          );
          currentRevReduc = (baseRev - claimMonthValue) / baseRev;
          priorRevReduc = (baseRev - prevClaimValue) / baseRev;
          //get the base rate
          baseRate = parseFloat(
            Math.max(getP5PlusBaseRate(revReduction), 0)
          );
          //get the top-up rate
          topUpRate = parseFloat(Math.max(getP5PlusTopUpRate(threeMonthReduction), 0));
          //calculate the overall rate
          cewsRate = (baseRate + topUpRate).toFixed(4);
          if (cewsRate < 0.1) {
            $("#employees").addClass("hidden");
          }
          if (cewsRate < 0.75 && revReduction >= 0.3 && claimPeriod < 7) {
            //if safe harbour applies
            cewsRate = 0.75;
            $("#rate-reduction").addClass("hidden");
            $(".safe-harbour-show").removeClass("hidden");
            $(".safe-harbour-hide").addClass("hidden");
          } else {
            //if safe harbour doesn't apply
            $(".safe-harbour-show").addClass("hidden");
            $(".safe-harbour-hide").removeClass("hidden");
            //update the view and round down base and top up dates to nearest 2 decimals on the percentage
            $(".top-up-rate-alt").text(roundPercDown(topUpRate) + "%");
            $(".base-rate-alt").text(roundPercDown(baseRate) + "%");
          }
          $("#currentRevReduction-alt").text(roundPercDown(currentRevReduc) + "%");
          $("#priorRevReduction-alt").text(roundPercDown(priorRevReduc) + "%");
          $(".rev-drop-top-up-alt").text(roundPercDown(threeMonthReduction) + "%");
          $(".rev-reduc-alt-base").text(roundPercDown(revReduction) + "%");
          $("#cews-rate-alt").text(Math.floor(cewsRate * 10000) / 100 + "%");
          $("#employees").removeClass("hidden");
        } else {
          //if it can't compute because of 0 values, then reset calculation summary to 0
          $("#currentRevReduction-alt").text("0%");
          $("#priorRevReduction-alt").text("0%");
          $(".top-up-rate-alt").text("0%");
          $(".base-rate-alt").text("0%");
          $(".rev-drop-top-up-alt").text("0%");
          $(".rev-reduc-alt-base").text("0%");
          $("#cews-rate-alt").text("0%");
        }
      });

      /**
       * roundPercDown()
       * round the given percent value to two decimal places
       */
      function roundPercDown(perc) {
        perc = perc * 10000;
        perc = Math.floor(perc);
        perc = perc / 100;
        return perc;
      }

      /**
       * zeroIfEmpty()
       * return 0 if the number cannot be parsed into a float; does not account * for letter values.
       */
      function zeroIfEmpty(fieldVal) {
        if (fieldVal != null && fieldVal != "") {
          return parseFloat(fieldVal);
        } else {
          return 0;
        }
      }

      //update the employee wages summary when the arms length value is changed
      $(document).on("change", "select[id^='arms-']", function (event) {
        //get the employee number
        var target = event.target;
        var id = target.id.split('-')[1];
        //trigger the blur event on all the inputs for the employees wages to recalculate
        $("#wkone-" + id).blur();
        $("#wktwo-" + id).blur();
        $("#wkthree-" + id).blur();
        $("#wkfour-" + id).blur();
      });
      //update the employee wage summary when the baseline value is changed
      $(document).on("blur", "input[id^='baseline-']", function (event) {
        //get the employee number
        var target = event.target;
        var id = target.id.split('-')[1];
        //trigger the blur event on all the inputs for the employees wages to recalculate
        $("#wkone-" + id).blur();
        $("#wktwo-" + id).blur();
        $("#wkthree-" + id).blur();
        $("#wkfour-" + id).blur();
      });

      /**
       * run the blur event for the wage input when the corresponding leave 
       * with pay option is checked
       */
      $(document).on("click", ".emp-lv > *", function (event) {
        leaveWithPayStateChanged(event);
      });
      function leaveWithPayStateChanged(event) {
        var target = null;
        //keypress event will send the checkbox as the event target
        if (event.target.nodeName == 'INPUT') {
          target = $("label[for='" + event.target.id + "']");
        } else {
          target = event.target;
        }
        var forValue = $(target).attr("for");
        var parts = forValue.split('-');
        var wageInputId = parts[0] + '-' + parts[2];
        $("#" + wageInputId).blur();
      }

      //send data to fields in 2B
      $(document).on("click", "#transfer-data", function (event) {
        calculateTotals();
        if ($("#claim-period option:selected").data("claim-period") >= 5) {
          var numWeeksLeaveWPay = $("input[id*='-cb-']:checked").length;
          var eligibleEmps = numEmployeePanels - (0.25 * numWeeksLeaveWPay);
          //eligible active employees
          $("#p2c-ee-alt1").val(Math.ceil(eligibleEmps));
          $("#p2c-ee-alt1").trigger("change");
          //get eligible furloughed employees
          $("#p2c-ee-alt2").val(Math.ceil(numEmployeePanels - eligibleEmps));
          $("#p2c-ee-alt2").trigger("change");
          if ($("#p2c-ee-alt2").val() == 0) {
            $("#p3-ei").prop("readonly", true);
            $("#p3-ei").val("0.00");
            $("#p3-cpp").prop("readonly", true);
            $(".p3-ee-req").addClass("hidden");
            $("#p3-cpp").val("0.00");
            $(".no-lwp-disclaimer").removeClass("hidden");
          } else {
            $("#p3-ei").prop("readonly", false);
            $("#p3-ei").val("");
            $("#p3-cpp").prop("readonly", false);
            $(".p3-ee-req").removeClass("hidden");
            $("#p3-cpp").val("");
            $(".no-lwp-disclaimer").addClass("hidden");
          }
          var totalWages = $(".total").attr("data-total-wages");
          $("#p2c-pyrl").val(totalWages);
          $("#p2c-pyrl").trigger("change");
          var totalCews = $(".total").attr("data-total-cews");
          $("#p2c-cews").val(totalCews);
          $("#p2c-cews").trigger("change");
          var revenueDisplay = Math.max(0, roundPercDown(currentRevReduc));
          $("#p2b-c1").val(revenueDisplay);
          $("output[for='p2b-c1']").text(revenueDisplay + "%");
          var threeMonthRevenueDisplay = Math.max(0, roundPercDown(threeMonthReduction));
          $("#p2b-c2").val(threeMonthRevenueDisplay);
          $("output[for='p2b-c2']").text(threeMonthRevenueDisplay + "%");
          $("#p2b-c3").val(roundPercDown(cewsRate));
          $("output[for='p2b-c3']").text(roundPercDown(cewsRate) + "%");
        } else {
          var eligibleEmployees = $("fieldset[id^='emp-']").length;
          for (var i = 1; i < $("fieldset[id^='emp-']").length; i++) {
            if ($("#emp-smry-" + i).hasClass("hidden")) {
              eligibleEmployees--;
            }
          }
          $("#p2c-ee").val(eligibleEmployees);
          $("#p2c-ee").trigger("change");
          var totalWages = $(".total").attr("data-total-wages");
          $("#p2c-pyrl").val(totalWages);
          $("#p2c-pyrl").trigger("change");
          var totalCews = $(".total").attr("data-total-cews");
          $("#p2c-cews").val(totalCews);
          $("#p2c-cews").trigger("change");
        }
        for (var i = 1; i < (numEmployeePanels + 1); i++) {
          $("#wkone-" + i).blur();
          $("#wktwo-" + i).blur();
          $("#wkthree-" + i).blur();
          $("#wkfour-" + i).blur();
        }
      });


      $(document).on("blur", "#p2c-ee-alt2", function(event) {
        if (event.target.value == 0) {
          $("#p3-ei").prop("readonly", true);
          $("#p3-ei").val("0.00");
          $("#p3-cpp").prop("readonly", true);
          $("#p3-cpp").val("0.00");
          $(".p3-ee-req").addClass("hidden");
          $(".no-lwp-disclaimer").removeClass("hidden");
        } else {
          $("#p3-ei").prop("readonly", false);
          $("#p3-ei").val("");
          $("#p3-cpp").prop("readonly", false);
          $("#p3-cpp").val("");
          $(".no-lwp-disclaimer").addClass("hidden");
          $(".p3-ee-req").removeClass("hidden");
        }
      });

      //update percentage summary elements in 2B 
      $(document).on("blur", "#p2b-c1", function (event) {
        $("output[for='p2b-c1']").text(zeroIfEmpty(event.target.value) + "%");
      });
      $(document).on("blur", "#p2b-c2", function (event) {
        $("output[for='p2b-c2']").text(zeroIfEmpty(event.target.value) + "%");
      });
      $(document).on("blur", "#p2b-c3", function (event) {
        $("output[for='p2b-c3']").text(zeroIfEmpty(event.target.value) + "%");
      });

      /**
       * getClaimMonth()
       * 
       * get the month where the claim period mostly falls
       * 
       * @param {Int} dateRange the claim period dates in 
       * YYYY-MM-DD--YYYY--MM-DD format
       * 
       * @return {Int} the claim month in numeric form 
       */
      function getClaimMonth(dateRange) {
        var dates = dateRange.split('--');
        var date1Arr = dates[0].split("-");
        var date2Arr = dates[1].split("-");
        var date1 = new Date(Date.UTC(date1Arr[0], date1Arr[1], date1Arr[2]));
        var date2 = new Date(Date.UTC(date2Arr[0], date2Arr[1], date2Arr[2]));
        var date1Counter = 0;
        var date1Month = date1.getUTCMonth();
        var date2Counter = 0;
        var date2Month = date2.getUTCMonth();
        if (date1Month == date2Month) {
          return date1Month + 1;
        }
        while (date1Month == date1.getUTCMonth()) {
          date1Counter++;
          date1.setUTCDate(date1.getUTCDate() + 1);
        }
        while (date2Month == date2.getUTCMonth()) {
          date2Counter++;
          date2.setUTCDate(date2.getUTCDate() - 1);
        }
        if (parseInt(date1Counter) < parseInt(date2Counter)) {
          return date2Month + 1;
        } else if (parseInt(date1Counter) > parseInt(date2Counter)) {
          return date1Month + 1;
        } else {
          return null;
        }
      }

      /**
       * Calculate the top up rate
       * 
       * @param {Float} reduction the percentage average three month revenue 
       * reduction represented as a decimal
       *
       * @return {Float} the top up rate
       */
      function getP5PlusTopUpRate(reduction) {
        if (1.25 * (reduction - 0.5) > 0.25) {
          return 0.25;
        } else {
          return 1.25 * (reduction - 0.5);
        }
      }

      /**
       * Calculate the base rate
       * @param {Float} revReduction the revenue reduction percentage 
       * represented as a decimal
       *  
       * @return {Float} the calculated base rate
       */
      function getP5PlusBaseRate(revReduction) {
        //max base and period for P5+
        var maxBase = [0.6, 0.6, 0.5, 0.4, 0.2];
        var scaleBase = [1.2, 1.2, 1.0, 0.8, 0.4];
        var period = $("#claim-period option:selected").data("claim-period");
        if (scaleBase[period - 5] * revReduction > maxBase[period - 5]) {
          return maxBase[period - 5];
        } else {
          return scaleBase[period - 5] * revReduction;
        }
      }

      /**
       * Calculate the employee CEWS amount with the p1-4 formula
       *
       * @param {Boolean} armsLength whether the employee is at arms length
       * @param {Int} weeklyRemun the employees weekly pay being calculated
       * @param {Int} baselineRemun the employees baseline pre-crisis pay
       *
       * @return {Int} the calculated weekly CEWS amount 
       */
      function oldFormula(armsLength, weeklyRemun, baselineRemun) {
        if (armsLength) {
          return Math.max(
            Math.min(0.75 * weeklyRemun, 847),
            Math.min(0.75 * baselineRemun, weeklyRemun, 847)
          );
        } else {
          return Math.max(0, Math.min(847, weeklyRemun, baselineRemun * 0.75));
        }
      }

      /**
       * Calculate the employee cews amount with the P5+ formula
       *
       * @param {Boolean} armsLength whether the employee is at arms length
       * @param {Int} weeklyRemun the employees weekly pay being calculated
       * @param {Int} baselineRemun the employees baseline pre-crisis pay
       * @param {String} overall the overall CEWS rate 
       *  
       * @return {Int} the calculated weekly CEWS amount    
       */
      function newFormula(armsLength, weeklyRemun, baselineRemun, overall) {
        if (armsLength) {

          return Math.min(1129, weeklyRemun) * overall;
        } else {
          return Math.min(1129, weeklyRemun, baselineRemun) * overall;
        }
      }

      // Bind the init event of the plugin
      $document.on("timerpoke.wb " + initEvent, selector, init);
      // Add the timer poke to initialize the plugin
      wb.add(selector);
    })(jQuery, window, wb);
    $(document).on("wb-ready.wb", function () {
      $("#rate-reduction").addClass("hidden");
      $("#reduction-percent-panel").addClass("hidden");
    });
    // TODO: Escape commas and whitespaces in input[type=number] in IE and Edge(Trident)


    //fix for duplicated popup trigger
    $(document).on("click", ".arms-length-def", function (event) {
      showPopup("armslength");
    });
    $(document).on("click", ".baseline-rem-def", function (event) {
      showPopup("baseline-rem");
    });
    $(document).on("click", ".pay-claim-def", function (event) {
      showPopup("pay-claim");
    });
    $(document).on("click", ".toCSV", function (event) {
      export_table_to_csv("employee-cews.csv");
    });

    /**
     * export_table_to_csv
     *
     * https://jsfiddle.net/gengns/j1jm2tjx/
     */
    function export_table_to_csv(filename) {
      var csv = [];
      var rows = $("#dataset-filter tr");
      for (var i = 0; i < rows.length; i++) {
        var row = [], cols = rows[i].querySelectorAll("td, th");

        for (var j = 0; j < cols.length; j++) {
          if (document.documentElement.lang == "fr") {
            var val = cols[j].innerText.replace(",", ".");
            val = val.replace(/,/g, ".")
            val = val.replace(/\s/g, "")
            row.push(val);
          } else {
            row.push(cols[j].innerText.replace(",", ""));
          }
        }

        csv.push(row.join(","));
      }
      // Download CSV
      download_csv(csv.join("\n"), filename);
    }
    /**
     * download_csv
     *
     * https://jsfiddle.net/gengns/j1jm2tjx/
     * 
     */
    function download_csv(csv, filename) {
      var csvFile;
      var downloadLink;

      // CSV FILE
      csv = "\uFEFF" + csv;
      csvFile = new Blob([csv], { type: "text/csv", encoding: "UTF-8" });

      // Download link
      downloadLink = document.createElement("a");

      // File name
      downloadLink.download = filename;

      // We have to create a link to the file
      downloadLink.href = window.URL.createObjectURL(csvFile);

      // Make sure that the link is not displayed
      downloadLink.style.display = "none";

      // Add the link to your DOM
      document.body.appendChild(downloadLink);

      // Lanzamos
      downloadLink.click();
    }

    /**
     * required to allow duplicated popup buttons to open the associated popup
     */
    function showPopup(id) {
      (function ($, wb) {
        'use strict';
        var $document = wb.doc;
        $document.trigger("open.wb-lbx", [
          [
            {
              src: "#" + id,
              type: "inline"
            }
          ],
          false
        ]);
      })(jQuery, wb);
    }

    $(document).on("blur", "input[id^='ee-name-']", function(event) {
      var className = $(event.target).prop("id");
      var empNumber = $(event.target).prop('id').split("-")[2];
      var displays = $("span." + className);
      var displayValue = "";
      if (empNumber > 0 && event.target.value == "") {
        displayValue = "Employee " + empNumber;
      } else {
        displayValue = event.target.value;
      }
      $(displays).each(function(i, element) {
        $(element).text(displayValue);
      });
    });
  </script>
  <script>

    $(".action-checkbox").change(function () {
      if ($('.action-checkbox:checked').length == $('.action-checkbox').length) {
        $("#action-msg1").removeClass("hidden").addClass("visible");
        $("#action-no-msg").addClass("hidden").removeClass("visible");
      }
      if ($('.action-checkbox:checked').length !== $('.action-checkbox').length) {
        $("#action-msg1").addClass("hidden").removeClass("visible");
        $("#action-no-msg").removeClass("hidden").addClass("visible");
      }
    })

  </script>
</body>

</html>
